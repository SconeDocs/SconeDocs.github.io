



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Scone Documentation - Secure Containers">
      
      
        <link rel="canonical" href="https://sconedocs.github.io/ProductionModeCAS/">
      
      
        <meta name="author" content="Christof Fetzer">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/scone-favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Outline - SCONE</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#outline" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://sconedocs.github.io" title="SCONE" class="md-header-nav__button md-logo">
          
            <img src="../img/logo-yellow-square.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              SCONE
            </span>
            <span class="md-header-nav__topic">
              
                Outline
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://sconedocs.github.io" title="SCONE" class="md-nav__button md-logo">
      
        <img src="../img/logo-yellow-square.png" width="48" height="48">
      
    </a>
    SCONE
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href=".." title="Executive summary" class="md-nav__link">
      Executive summary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../advantages/" title="Advantages of SCONE" class="md-nav__link">
      Advantages of SCONE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../technical_summary/" title="Technical summary of SCONE" class="md-nav__link">
      Technical summary of SCONE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../buildingApps/" title="(No) Cross-Compilation" class="md-nav__link">
      (No) Cross-Compilation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../curated_images/" title="Curated Images" class="md-nav__link">
      Curated Images
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../scone-use-case-overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../secure_remote_execution/" title="Secure Remote Execution" class="md-nav__link">
      Secure Remote Execution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dockerfileexample/" title="Dockerfile Example" class="md-nav__link">
      Dockerfile Example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../multistagebuild/" title="Multi-stage build" class="md-nav__link">
      Multi-stage build
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../groupcacheUseCase/" title="GO example" class="md-nav__link">
      GO example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../memory_dump/" title="Finding Secrets" class="md-nav__link">
      Finding Secrets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dapps/" title="Trusted DApps" class="md-nav__link">
      Trusted DApps
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Configuration & Attestation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Configuration & Attestation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../CASOverview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cas_intro/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CASIntro/" title="Starting CAS" class="md-nav__link">
      Starting CAS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../LASIntro/" title="Starting LAS" class="md-nav__link">
      Starting LAS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cas_blender_example/" title="Posting Sessions" class="md-nav__link">
      Posting Sessions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../print-arg-env/" title="Secure Arguments" class="md-nav__link">
      Secure Arguments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../EncryptedWordCount/" title="Encrypted Code and Input" class="md-nav__link">
      Encrypted Code and Input
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Use Cases
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Use Cases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../usecases/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../blender/" title="Blender" class="md-nav__link">
      Blender
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pyspark/" title="PySpark" class="md-nav__link">
      PySpark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tensorflow/" title="TensorFlow" class="md-nav__link">
      TensorFlow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tensorflowlite/" title="TensorFlow Lite" class="md-nav__link">
      TensorFlow Lite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vault/" title="Vault" class="md-nav__link">
      Vault
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Execution Modes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Execution Modes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../outline/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../firstcontainer/" title="Simulation Mode" class="md-nav__link">
      Simulation Mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hardwaremode/" title="Hardware Mode" class="md-nav__link">
      Hardware Mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hostexample/" title="Host Execution" class="md-nav__link">
      Host Execution
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../installation/" title="Installation overview" class="md-nav__link">
      Installation overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dockerinstall/" title="Installing docker" class="md-nav__link">
      Installing docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sgxinstall/" title="Installing Intel SGX driver" class="md-nav__link">
      Installing Intel SGX driver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconeinstall/" title="Installing SCONE" class="md-nav__link">
      Installing SCONE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../microcode/" title="Updating CPU microcode" class="md-nav__link">
      Updating CPU microcode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../iexec_install/" title="Patched driver & engine" class="md-nav__link">
      Patched driver & engine
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Language Support
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Language Support
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../C/" title="C" class="md-nav__link">
      C
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../C++/" title="C++" class="md-nav__link">
      C++
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Fortran/" title="Fortran" class="md-nav__link">
      Fortran
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../GO/" title="GO" class="md-nav__link">
      GO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Java/" title="Java" class="md-nav__link">
      Java
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python/" title="Python" class="md-nav__link">
      Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pypyscone/" title="PyPy" class="md-nav__link">
      PyPy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Nodejs/" title="Node" class="md-nav__link">
      Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../R/" title="R" class="md-nav__link">
      R
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Rust/" title="Rust" class="md-nav__link">
      Rust
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      IDE Integration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        IDE Integration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eclipse/" title="Eclipse" class="md-nav__link">
      Eclipse
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Command Line Interface
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Command Line Interface
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_CLI/" title="SCONE CLI" class="md-nav__link">
      SCONE CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_toolchain/" title="SCONE SGX toolchain" class="md-nav__link">
      SCONE SGX toolchain
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Curated_Images/" title="SCONE Curated Images" class="md-nav__link">
      SCONE Curated Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_TUTORIAL/" title="SCONE Static vs Dynamic" class="md-nav__link">
      SCONE Static vs Dynamic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_GENERATE_IMAGE/" title="SCONE Create Image" class="md-nav__link">
      SCONE Create Image
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Dockerfile/" title="SCONE Dockerfile" class="md-nav__link">
      SCONE Dockerfile
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Manuals
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Manuals
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Fileshield/" title="scone fspf" class="md-nav__link">
      scone fspf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_ENV/" title="environment variables" class="md-nav__link">
      environment variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../MrEnclave/" title="MrEnclave" class="md-nav__link">
      MrEnclave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fork/" title="fork" class="md-nav__link">
      fork
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../performance/" title="Performance" class="md-nav__link">
      Performance
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      Background
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        Background
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../appsecurity/" title="Application-Oriented Security" class="md-nav__link">
      Application-Oriented Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../background/" title="SCONE Background" class="md-nav__link">
      SCONE Background
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../SCONE_Publications/" title="Publications" class="md-nav__link">
      Publications
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../aboutScone/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cas-production-version" class="md-nav__link">
    CAS Production Version
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#root-cas" class="md-nav__link">
    Root CAS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cas-configuration-protection" class="md-nav__link">
    CAS Configuration Protection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cas-attestation" class="md-nav__link">
    CAS Attestation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cas-attestation-api" class="md-nav__link">
    CAS Attestation API
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-parameters" class="md-nav__link">
    Query parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proof-data" class="md-nav__link">
    Proof Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-data" class="md-nav__link">
    Additional Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response-status-codes" class="md-nav__link">
    Response Status Codes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-cas-attestation-with-iasreport-method" class="md-nav__link">
    Example: CAS Attestation with IASReport method
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-cas-attestation-with-epid-method" class="md-nav__link">
    Example: CAS Attestation with EPID method
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scone-cli-extension" class="md-nav__link">
    scone CLI extension
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#policy-access-control" class="md-nav__link">
    Policy Access Control
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#predefined-names" class="md-nav__link">
    Predefined Names
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#palaemon-operations-on-sessions" class="md-nav__link">
    PALAEMON Operations on sessions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-access-control" class="md-nav__link">
    Example: Access Control
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-acl" class="md-nav__link">
    Default ACL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-policy-readable-by-all-clients" class="md-nav__link">
    Example: Policy Readable by all Clients
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-immutable-policy" class="md-nav__link">
    Example: Immutable Policy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automatic-volume-creation" class="md-nav__link">
    Automatic Volume Creation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#palaemon-files" class="md-nav__link">
    PALAEMON Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-certificates" class="md-nav__link">
    Service Certificates
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#certificate-chain" class="md-nav__link">
    Certificate Chain
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="outline">Outline<a class="headerlink" href="#outline" title="Permanent link">&para;</a></h1>
<p>We describe the following aspects of CAS:</p>
<ul>
<li>CAS Production Version</li>
<li>CAS Attestation</li>
<li>Policy Access Control</li>
<li>PALAEMON Operations on sessions</li>
<li>Automatic Volume Creation</li>
<li>Palaemon Files</li>
<li>Service Certificates</li>
</ul>
<h2 id="cas-production-version">CAS Production Version<a class="headerlink" href="#cas-production-version" title="Permanent link">&para;</a></h2>
<p>The SCONE CAS (Configuration and Attestation Service) - a.k.a. Palaemon - manages secrets and hence, must be protected by running inside of a production enclave and encrypting its database which is stored in the filesystem. Encrypting files is transparent to applications running in the context of a CAS: CAS attests the application and then passes its filesystem keys to the application. Actually, it passes the keys to the SCONE runtime of the application and the runtime transparently encrypts files on writes and decrypts files on reads.</p>
<p>CAS can run in the context of a <em>parent</em> CAS to manage the filesystem keys of the <em>child</em> CAS. <strong>This is the preferred way to run CAS</strong>. However, there always exists a CAS that does not have a parent CAS: we call this a <strong>root CAS</strong>. We describe the principles of operating a root CAS below.</p>
<h3 id="root-cas">Root CAS<a class="headerlink" href="#root-cas" title="Permanent link">&para;</a></h3>
<p>Scontain.com operates its own <strong>root CAS</strong>. Customers might, however, want to operate their own <strong>rootCAS</strong>. This root CAS runs inside an enclave and uses an encrypted filesystem.</p>
<p>Starting up a root CAS is different from a <em>child</em> CAS:
 A root CAS uses the SGX sealing key (mrenclave-based) to encrypt its database. This can be enabled by setting <code class="codehilite"><span class="n">sealed</span></code> to <code class="codehilite"><span class="k">true</span></code> in the CAS config file, in the database section. If this option is enabled during the first start of CAS, it will</p>
<ol>
<li>create a <code class="codehilite"><span class="n">volume</span><span class="p">.</span><span class="n">fspf</span></code> with an encrypted region for the database file (<code class="codehilite"><span class="n">palaemon</span><span class="p">.</span><span class="n">db</span></code>),</li>
<li>encrypt the <code class="codehilite"><span class="n">volume</span><span class="p">.</span><span class="n">fspf</span></code> with the sealing key and store the fspf file in the fs,</li>
<li>initialize the FS shield with the newly created <code class="codehilite"><span class="n">volume</span><span class="p">.</span><span class="n">fspf</span></code>, and</li>
<li>create an empty <code class="codehilite"><span class="n">palaemon</span><span class="p">.</span><span class="n">db</span></code> in this protected volume.</li>
</ol>
<p>Note that the creation is done inside of the enclave, i.e., only the encrypted DB and volume.fspf is visible outside of the enclave. During subsequent runs, CAS will detect that the volume/database already exist, and will simply initialize the FS shield using already existing volume.fspf.</p>
<p><strong>Limitations:</strong>
The <strong>root CAS</strong> does no have rollback protection: Intel has stopped supporting monotonic counters which are implemented by the Intel Management Engine (ME) when using Linux.  We plan to add rollback protection in a later version of CAS using an alternative mechanism.</p>
<h3 id="cas-configuration-protection">CAS Configuration Protection<a class="headerlink" href="#cas-configuration-protection" title="Permanent link">&para;</a></h3>
<p>As we mentioned above, the CAS configuration file will need to set <code class="codehilite"><span class="n">sealed</span></code> to <code class="codehilite"><span class="k">true</span></code>. An attacker could try to attack the initial configuration of CAS. Hence, the CAS configuration file needs to be protected too, as it contains security relevant configuration options. For example, it contains hashes of trusted SCONE quoting enclaves. One possibility would be to hardcode the config into CAS itself, however this is not sufficiently flexible since modifications of a config requires CAS recompilation.</p>
<p>We use a different approach: we tie the fs tag with the mrenclave by adding the tag into enclave_parms structure. This can be done by setting <code class="codehilite"><span class="n">SCONE_FSPF_TAG</span></code> during enclave signing to provide fspf tag that shall be added to enclave_parms, e.g.</p>
<div class="codehilite"><pre><span></span>$ <span class="nv">SCONE_FSPF_TAG</span><span class="o">=</span>84cae7af24a94f52f5de5dd36c1843dc scone-signer sign /myapp
</pre></div>

<p>Since mrenclave with this approach depends on the fspf tag, a client can make sure that the configuration file has not been manipulated by performing CAS attestation.</p>
<p>If an application was signed with <code class="codehilite"><span class="n">SCONE_FSPF_TAG</span></code>, environment variable <code class="codehilite"><span class="n">SCONE_BOOTSTRAP_FSPF</span></code> shall be used to provide path to FSPF (the runtime will terminate execution if it detects that it has an expected fspf tag, but no FSPF was provided):</p>
<div class="codehilite"><pre><span></span><span class="nv">SCONE_BOOTSTRAP_FSPF</span><span class="o">=</span>/fspf.pb /myapp
</pre></div>

<p>During FS shield initialization, fspf tag from enclave_parms must match the tag of the FSPF provided via SCONE_BOOTSTRAP_FSPF, otherwise execution will be terminated. Note that when <code class="codehilite"><span class="n">SCONE_BOOTSTRAP_FSPF</span></code> is used, no application arguments or environment variables will be passed to the application, as they cannot be trusted (this would require application-level modifications to check whether args and env are sane).</p>
<p>To protect CAS, we create a FSPF covering everything that needs to be integrity protected, and use <code class="codehilite"><span class="n">SCONE_FSPF_TAG</span></code> to add the tag into mrenclave of CAS.</p>
<p>Limitations:
- read-only file system
- no args/env
- no secrets in the initial fs state</p>
<h2 id="cas-attestation">CAS Attestation<a class="headerlink" href="#cas-attestation" title="Permanent link">&para;</a></h2>
<p>To establish trust into a root CAS, the client needs to perform a remote attestation of the root CAS. CAS provides a REST endpoint (<code class="codehilite"><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">attest</span></code>) to request its quote, which can then be validated by a remote party. The quote will contain a hash of the CAS's certificate chain (in the report data), allowing the client to verify whether the hash of the certificates presented by CAS matches the hash in the report data, and use these certificates for future communication with CAS without the need for re-attestation.</p>
<h3 id="cas-attestation-api">CAS Attestation API<a class="headerlink" href="#cas-attestation-api" title="Permanent link">&para;</a></h3>
<p>The following types of attestation information are provided by CAS:</p>
<ul>
<li><code class="codehilite"><span class="n">IAS</span> <span class="n">verification</span> <span class="n">report</span></code> (<code class="codehilite"><span class="n">IASReport</span></code>) - verification report provided by the Intel Attestation Service (IAS)</li>
<li><code class="codehilite"><span class="n">EPID</span> <span class="n">quote</span></code> (<code class="codehilite"><span class="n">EPID</span></code>) - unverified quote produced by a quoting enclave. Such quote needs to be verified by the requester via IAS</li>
</ul>
<p>To request CAS attestation information, make a <code class="codehilite"><span class="k">GET</span></code> request to <code class="codehilite"><span class="n">v1</span><span class="o">/</span><span class="n">attest</span></code>,
for example:</p>
<div class="codehilite"><pre><span></span><span class="err">GET /v1/attest</span>
</pre></div>

<h3 id="query-parameters">Query parameters<a class="headerlink" href="#query-parameters" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>string</td>
<td>Type of requested attestation information. Accepted values: <code class="codehilite"><span class="n">IASReport</span></code>, <code class="codehilite"><span class="n">EPID</span></code>. If no type is specified, <code class="codehilite"><span class="n">IASReport</span></code> is assumed. <br> This is an optional field</td>
</tr>
<tr>
<td>nonce</td>
<td>16 byte hex string</td>
<td>Nonce to include in the request. <br> This is an optional field</td>
</tr>
<tr>
<td>spid</td>
<td>16 byte hex string</td>
<td>Identifier of the IAS user. Valid only for <code class="codehilite"><span class="n">EPID</span></code> requests.  <br> This is a mandatory field (if <code class="codehilite"><span class="k">type</span></code> is <code class="codehilite"><span class="n">EPID</span></code>)</td>
</tr>
<tr>
<td>linkable</td>
<td>boolean</td>
<td>Whether linkable or unlinkable signature scheme should be used.  Valid only for <code class="codehilite"><span class="n">EPID</span></code> requests. <br> This is a mandatory field (if <code class="codehilite"><span class="k">type</span></code> is <code class="codehilite"><span class="n">EPID</span></code>)</td>
</tr>
</tbody>
</table>
<h3 id="response">Response<a class="headerlink" href="#response" title="Permanent link">&para;</a></h3>
<p>Succesfull calls will be responded with a JSON map with the following fields:</p>
<table>
<thead>
<tr>
<th>field name</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>proof_data</td>
<td>Attestation result proving the software identity of CAS</td>
</tr>
<tr>
<td>additional_data</td>
<td>Additional data integrity protected via <code class="codehilite"><span class="n">proof</span></code></td>
</tr>
</tbody>
</table>
<h3 id="proof-data">Proof Data<a class="headerlink" href="#proof-data" title="Permanent link">&para;</a></h3>
<p><code class="codehilite"><span class="n">proof_data</span></code> is a JSON map.</p>
<p>The returned proof data depends on the requested attestation method.
Accordingly, "IASReport", and "EPID" proof data might be returned.
The returned type of the proof data is specified in the <code class="codehilite"><span class="k">type</span></code> field.</p>
<p><strong><code class="codehilite"><span class="n">IASReport</span></code></strong></p>
<p>The data returned for an <code class="codehilite"><span class="n">IASReport</span></code> is equivalent to the data obtained from Intel's IAS.
Please refer to
<a href="https://api.trustedservices.intel.com/documents/IAS-API-Spec-rev-4.0.pdf">Intel Attestation Service API documentation, section 3.2</a> for description of the individual data fields.
Data obtained from headers are put into the following JSON fields:
 - request_id
 - report_signature
 - signing_certificate
 - advisory_url
 - advisory_ids
 - body</p>
<p>The IAS response's body is found in the <code class="codehilite"><span class="n">body</span></code> field.
See the example below.</p>
<p><strong><code class="codehilite"><span class="n">EPID</span></code></strong></p>
<p>The proof data returned for an <code class="codehilite"><span class="n">EPID</span></code> quote is a JSON map with the following fields:</p>
<table>
<thead>
<tr>
<th>field</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>Will be "<code class="codehilite"><span class="n">EPID</span></code>"</td>
</tr>
<tr>
<td>quote</td>
<td>Base64 encoded EPID quote</td>
</tr>
<tr>
<td>spid</td>
<td>16-byte hex encoded IAS SPID specified in the request</td>
</tr>
<tr>
<td>linkable</td>
<td><code class="codehilite"><span class="k">true</span></code> or <code class="codehilite"><span class="k">false</span></code> as specified in the request</td>
</tr>
</tbody>
</table>
<p><code class="codehilite"><span class="n">spid</span></code> and <code class="codehilite"><span class="n">linkable</span></code> merely reflect the provided query parameters of the request.
For verification, <code class="codehilite"><span class="n">quote</span></code> has to be sent to Intel's IAS service.
IAS has to be queried with the specified <code class="codehilite"><span class="n">spid</span></code> and <code class="codehilite"><span class="n">linkable</span></code> settings to obtain verification reports successfully.</p>
<h3 id="additional-data">Additional Data<a class="headerlink" href="#additional-data" title="Permanent link">&para;</a></h3>
<p>The <code class="codehilite"><span class="n">additional_data</span></code> value of the response's JSON contains additional data that is integrity protected and sent along with the attestation proof.
This data is typically used to, but not limited to, transmit identification information and replay protection that is cryptographically bound to the attestation proof.</p>
<p>The <code class="codehilite"><span class="n">additional_data</span></code> values is a JSON map with the following fields:</p>
<table>
<thead>
<tr>
<th>field name</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>Must be "<code class="codehilite"><span class="n">CasAttestationDataV1</span></code>"</td>
</tr>
<tr>
<td>nonce</td>
<td>random number used during report request, making this data distinguishable from other attestation responses and, thus, protects against replay</td>
</tr>
<tr>
<td>cert_chain</td>
<td>certificate chain used by to secure network communication</td>
</tr>
</tbody>
</table>
<p>To protect the <code class="codehilite"><span class="n">additional_data</span></code>'s integrity it is hashed and its hash value is embedded in the <code class="codehilite"><span class="n">proof</span></code> field in an attestation method specific manner (see the Proof Data section below).
The hash is created by hashing <code class="codehilite"><span class="n">additional_data</span></code>'s unprettified JSON representation with SHA512 yielding a 64-byte long hash value.</p>
<h3 id="response-status-codes">Response Status Codes<a class="headerlink" href="#response-status-codes" title="Permanent link">&para;</a></h3>
<ul>
<li>200 ok - no error</li>
<li>400 bad request  - invalid argument</li>
<li>500 - internal server error</li>
</ul>
<h3 id="example-cas-attestation-with-iasreport-method">Example: CAS Attestation with IASReport method<a class="headerlink" href="#example-cas-attestation-with-iasreport-method" title="Permanent link">&para;</a></h3>
<p><em>Request</em></p>
<div class="codehilite"><pre><span></span><span class="nf">GET</span> <span class="nn">/v1/attest?type=IASReport&amp;nonce=12121212121212121212121212121211</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">cas:8081</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">curl/7.58.0</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">*/*</span>
</pre></div>

<p><em>Response</em></p>
<div class="codehilite"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">content-type</span><span class="o">:</span> <span class="l">application/json</span>
<span class="na">content-length</span><span class="o">:</span> <span class="l">6713</span>
<span class="na">date</span><span class="o">:</span> <span class="l">Fri, 19 Jul 2019 14:31:47 GMT</span>

<span class="p">{</span>
  <span class="nt">&quot;proof_data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;IASReport&quot;</span><span class="p">,</span>
    <span class="nt">&quot;request_id&quot;</span><span class="p">:</span> <span class="s2">&quot;04b865cb3b414e5ebfd960b72483993d&quot;</span><span class="p">,</span>
    <span class="nt">&quot;report_signature&quot;</span><span class="p">:</span> <span class="s2">&quot;L/JnqRwLET03VNJbw75Bss5bRuJ3p3SEb1CG8ZHwRqyiE87B7zzwY2MWtoV/zhIxIYyhm4Hw/mzvzlSJRDbXizJuhe3Flg8mRulytTpjOxW5nVqnZRBRFSN+jl+vbd9WKxXZgeSuwhwV+rUqaJqnH+eZj1hVTjO+icK0mJ8dODLl3mFkJh4ykMetYJOXNBuJ+GXlMOcUOV01gHcRiY25ecKMax+e9GeZFrur+JgMHhyi15xL+aPRLVMXem35e2NKVB8B2mMJw7WzeDywQTE0p8QOBXKhjGwk9t9yc5I8JJPTJcyixo619xagHNGSxdm+muJEDAyzAcJumU9xs6m54A==&quot;</span><span class="p">,</span>
    <span class="nt">&quot;signing_certificate&quot;</span><span class="p">:</span> <span class="s2">&quot;-----BEGIN CERTIFICATE-----\nMIIEoTCCAwmgAwIBAgIJANEHdl0yo7CWMA0GCSqGSIb3DQEBCwUAMH4xCzAJBgNV\nBAYTAlVTMQswCQYDVQQIDAJDQTEUMBIGA1UEBwwLU2FudGEgQ2xhcmExGjAYBgNV\nBAoMEUludGVsIENvcnBvcmF0aW9uMTAwLgYDVQQDDCdJbnRlbCBTR1ggQXR0ZXN0\nYXRpb24gUmVwb3J0IFNpZ25pbmcgQ0EwHhcNMTYxMTIyMDkzNjU4WhcNMjYxMTIw\nMDkzNjU4WjB7MQswCQYDVQQGEwJVUzELMAkGA1UECAwCQ0ExFDASBgNVBAcMC1Nh\nbnRhIENsYXJhMRowGAYDVQQKDBFJbnRlbCBDb3Jwb3JhdGlvbjEtMCsGA1UEAwwk\nSW50ZWwgU0dYIEF0dGVzdGF0aW9uIFJlcG9ydCBTaWduaW5nMIIBIjANBgkqhkiG\n9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqXot4OZuphR8nudFrAFiaGxxkgma/Es/BA+t\nbeCTUR106AL1ENcWA4FX3K+E9BBL0/7X5rj5nIgX/R/1ubhkKWw9gfqPG3KeAtId\ncv/uTO1yXv50vqaPvE1CRChvzdS/ZEBqQ5oVvLTPZ3VEicQjlytKgN9cLnxbwtuv\nLUK7eyRPfJW/ksddOzP8VBBniolYnRCD2jrMRZ8nBM2ZWYwnXnwYeOAHV+W9tOhA\nImwRwKF/95yAsVwd21ryHMJBcGH70qLagZ7Ttyt++qO/6+KAXJuKwZqjRlEtSEz8\ngZQeFfVYgcwSfo96oSMAzVr7V0L6HSDLRnpb6xxmbPdqNol4tQIDAQABo4GkMIGh\nMB8GA1UdIwQYMBaAFHhDe3amfrzQr35CN+s1fDuHAVE8MA4GA1UdDwEB/wQEAwIG\nwDAMBgNVHRMBAf8EAjAAMGAGA1UdHwRZMFcwVaBToFGGT2h0dHA6Ly90cnVzdGVk\nc2VydmljZXMuaW50ZWwuY29tL2NvbnRlbnQvQ1JML1NHWC9BdHRlc3RhdGlvblJl\ncG9ydFNpZ25pbmdDQS5jcmwwDQYJKoZIhvcNAQELBQADggGBAGcIthtcK9IVRz4r\nRq+ZKE+7k50/OxUsmW8aavOzKb0iCx07YQ9rzi5nU73tME2yGRLzhSViFs/LpFa9\nlpQL6JL1aQwmDR74TxYGBAIi5f4I5TJoCCEqRHz91kpG6Uvyn2tLmnIdJbPE4vYv\nWLrtXXfFBSSPD4Afn7+3/XUggAlc7oCTizOfbbtOFlYA4g5KcYgS1J2ZAeMQqbUd\nZseZCcaZZZn65tdqee8UXZlDvx0+NdO0LR+5pFy+juM0wWbu59MvzcmTXbjsi7HY\n6zd53Yq5K244fwFHRQ8eOB0IWB+4PfM7FeAApZvlfqlKOlLcZL2uyVmzRkyR5yW7\n2uo9mehX44CiPJ2fse9Y6eQtcfEhMPkmHXI01sN+KwPbpA39+xOsStjhP9N1Y1a2\ntQAVo+yVgLgV2Hws73Fc0o3wC78qPEA+v2aRs/Be3ZFDgDyghc/1fgU+7C+P6kbq\nd4poyb6IW8KCJbxfMJvkordNOgOUUxndPHEi/tb/U7uLjLOgPA==\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIFSzCCA7OgAwIBAgIJANEHdl0yo7CUMA0GCSqGSIb3DQEBCwUAMH4xCzAJBgNV\nBAYTAlVTMQswCQYDVQQIDAJDQTEUMBIGA1UEBwwLU2FudGEgQ2xhcmExGjAYBgNV\nBAoMEUludGVsIENvcnBvcmF0aW9uMTAwLgYDVQQDDCdJbnRlbCBTR1ggQXR0ZXN0\nYXRpb24gUmVwb3J0IFNpZ25pbmcgQ0EwIBcNMTYxMTE0MTUzNzMxWhgPMjA0OTEy\nMzEyMzU5NTlaMH4xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTEUMBIGA1UEBwwL\nU2FudGEgQ2xhcmExGjAYBgNVBAoMEUludGVsIENvcnBvcmF0aW9uMTAwLgYDVQQD\nDCdJbnRlbCBTR1ggQXR0ZXN0YXRpb24gUmVwb3J0IFNpZ25pbmcgQ0EwggGiMA0G\nCSqGSIb3DQEBAQUAA4IBjwAwggGKAoIBgQCfPGR+tXc8u1EtJzLA10Feu1Wg+p7e\nLmSRmeaCHbkQ1TF3Nwl3RmpqXkeGzNLd69QUnWovYyVSndEMyYc3sHecGgfinEeh\nrgBJSEdsSJ9FpaFdesjsxqzGRa20PYdnnfWcCTvFoulpbFR4VBuXnnVLVzkUvlXT\nL/TAnd8nIZk0zZkFJ7P5LtePvykkar7LcSQO85wtcQe0R1Raf/sQ6wYKaKmFgCGe\nNpEJUmg4ktal4qgIAxk+QHUxQE42sxViN5mqglB0QJdUot/o9a/V/mMeH8KvOAiQ\nbyinkNndn+Bgk5sSV5DFgF0DffVqmVMblt5p3jPtImzBIH0QQrXJq39AT8cRwP5H\nafuVeLHcDsRp6hol4P+ZFIhu8mmbI1u0hH3W/0C2BuYXB5PC+5izFFh/nP0lc2Lf\n6rELO9LZdnOhpL1ExFOq9H/B8tPQ84T3Sgb4nAifDabNt/zu6MmCGo5U8lwEFtGM\nRoOaX4AS+909x00lYnmtwsDVWv9vBiJCXRsCAwEAAaOByTCBxjBgBgNVHR8EWTBX\nMFWgU6BRhk9odHRwOi8vdHJ1c3RlZHNlcnZpY2VzLmludGVsLmNvbS9jb250ZW50\nL0NSTC9TR1gvQXR0ZXN0YXRpb25SZXBvcnRTaWduaW5nQ0EuY3JsMB0GA1UdDgQW\nBBR4Q3t2pn680K9+QjfrNXw7hwFRPDAfBgNVHSMEGDAWgBR4Q3t2pn680K9+Qjfr\nNXw7hwFRPDAOBgNVHQ8BAf8EBAMCAQYwEgYDVR0TAQH/BAgwBgEB/wIBADANBgkq\nhkiG9w0BAQsFAAOCAYEAeF8tYMXICvQqeXYQITkV2oLJsp6J4JAqJabHWxYJHGir\nIEqucRiJSSx+HjIJEUVaj8E0QjEud6Y5lNmXlcjqRXaCPOqK0eGRz6hi+ripMtPZ\nsFNaBwLQVV905SDjAzDzNIDnrcnXyB4gcDFCvwDFKKgLRjOB/WAqgscDUoGq5ZVi\nzLUzTqiQPmULAQaB9c6Oti6snEFJiCQ67JLyW/E83/frzCmO5Ru6WjU4tmsmy8Ra\nUd4APK0wZTGtfPXU7w+IBdG5Ez0kE1qzxGQaL4gINJ1zMyleDnbuS8UicjJijvqA\n152Sq049ESDz+1rRGc2NVEqh1KaGXmtXvqxXcTB+Ljy5Bw2ke0v8iGngFBPqCTVB\n3op5KBG3RjbF6RRSzwzuWfL7QErNC8WEy5yDVARzTA5+xmBc388v9Dm21HGfcC8O\nDD+gT9sSpssq0ascmvH49MOgjt1yoysLtdCtJW/9FZpoOypaHx0R+mJTLwPXVMrv\nDaVzWh5aiEx+idkSGMnX\n-----END CERTIFICATE-----\n&quot;</span><span class="p">,</span>
    <span class="nt">&quot;advisory_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://security-center.intel.com&quot;</span><span class="p">,</span>
    <span class="nt">&quot;advisory_ids&quot;</span><span class="p">:</span> <span class="s2">&quot;INTEL-SA-00233,INTEL-SA-00203&quot;</span><span class="p">,</span>
    <span class="nt">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;{\&quot;id\&quot;:\&quot;104078828093493237715491076693079367680\&quot;,\&quot;timestamp\&quot;:\&quot;2019-07-19T14:31:47.812532\&quot;,\&quot;version\&quot;:3,\&quot;epidPseudonym\&quot;:\&quot;vGG2Lg5xfy2265JaNDYDWx7zPyPl9ECQrmnlI/v+lOPQtwrfCfDK/6RCB0bDZGCTcBbkegtKYurrE1BTdbNX0AZrQWCg41yuuZWJfOqqgmQKsocNtcx0GvAFLjInk0mzGeeesD7WoYbEMMj2XvHiGK+cRpQ70mazM7c4YC4ruvI=\&quot;,\&quot;isvEnclaveQuoteStatus\&quot;:\&quot;GROUP_OUT_OF_DATE\&quot;,\&quot;platformInfoBlob\&quot;:\&quot;1502006504000700000909020401010100000000000000000008000009000000020000000000000AF9E2845415680090212746E93210A997D3FDFB85EA2090AF195255C2F71182C8AD108C5B84187F6DE950FEE178C92E89B07FC54CF7AD8228B0218562844D6823AB\&quot;,\&quot;isvEnclaveQuoteBody\&quot;:\&quot;AgABAPkKAAAHAAYAAAAAAC7FvmTiQrzJ5GcNSeXHCR4AAAAAAAAAAAAAAAAAAAAACAn//wECAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAfAAAAAAAAAHVq793Ho31tmAagb6EQ3HzMXJoz9yKstVHu0MeP0qsDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARxOFQt2wrFF9/rbbDBFXhBGueb7t1tJxuEzQa2KzFvQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAzMh8eWrOC5/EIlYntvTWkNfJSVc2HOpCDlSZkEJbiW3sU0wzzMHHnhQ4b1mMkTbgZa7xMtzpIrEbwci0TkFPN\&quot;}&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;additional_data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;CasAttestationDataV1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;nonce&quot;</span><span class="p">:</span> <span class="s2">&quot;12121212121212121212121212121211&quot;</span><span class="p">,</span>
    <span class="nt">&quot;cert_chain&quot;</span><span class="p">:</span> <span class="s2">&quot;-----BEGIN CERTIFICATE-----\r\nMIIBWjCCAQGgAwIBAgIJALIzkPeLoKKiMAoGCCqGSM49BAMCMA4xDDAKBgNVBAMM\r\nA2NhczAiGA8yMDE5MDcxOTEwMDUzMVoYDzIwMjAwNzE4MTAwNTMxWjAOMQwwCgYD\r\nVQQDDANjYXMwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASyDh3s+6Oauv+Zq0+r\r\nP9J0OTGHlLKD0PragTy/6iwr3wF8yDLbIzQGHlLhifSJRs/IuFsqPyEyIKihF/SM\r\nF8LGo0QwQjAJBgNVHREEAjAAMCcGA1UdDgQgicw+bI54mO3Jmc4sRYnYRfZFXghI\r\nW4JbIGMbckEjUwEwDAYDVR0TBAUwAwEB/zAKBggqhkjOPQQDAgNHADBEAiApbXda\r\nDj3OX//XG4bcj9w4CQ7AUAb9cjDVnKVwHoVIfgIgc0gBka1/+zQHk9IRP7OlaMeH\r\nx6kEZDjT7G8Ora2fTTk=\r\n-----END CERTIFICATE-----\r\n-----BEGIN CERTIFICATE-----\r\nMIIBYzCCAQqgAwIBAgIJAL+N9s5W/SUEMAoGCCqGSM49BAMCMA4xDDAKBgNVBAMM\r\nA2NhczAiGA8yMDE5MDcxOTEwMDUzMVoYDzIwMjAwNzE4MTAwNTMxWjAXMRUwEwYD\r\nVQQDDAxjYXMtaW5zdGFuY2UwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAQ/BSal\r\n8ViDYRB+F+SZCoqmiXefpHc4Eom0m3anOv/4D8r+lu7+INCbE2HK1LZXV5DYSF+G\r\nekUveC3Hu/RG/lbpo0QwQjAJBgNVHREEAjAAMCcGA1UdDgQglcUQg4sXlnl6L2Yq\r\nVSiIunz6VP7PXoGopkIFf5A7YL8wDAYDVR0TBAUwAwEB/zAKBggqhkjOPQQDAgNH\r\nADBEAiAgBJfcUx6ch+yjDU60xqHlcrcUG3OI8L9YIui63hn1xgIgE1t3NHBm/MH7\r\nFrz2nE/TE99uhYEAnSWwX7kXzl6z/sM=\r\n-----END CERTIFICATE-----\r\n&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h3 id="example-cas-attestation-with-epid-method">Example: CAS Attestation with EPID method<a class="headerlink" href="#example-cas-attestation-with-epid-method" title="Permanent link">&para;</a></h3>
<p><em>Request</em></p>
<div class="codehilite"><pre><span></span><span class="nf">GET</span> <span class="nn">/v1/attest?type=EPID&amp;nonce=12121212121212121212121212121211&amp;spid=12121212121212121212121212121211&amp;linkable=false</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">localhost:8081</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">curl/7.58.0</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">*/*</span>
</pre></div>

<p><em>Response</em></p>
<div class="codehilite"><pre><span></span><span class="err">HTTP/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="err">OK</span>
<span class="err">content-type:</span> <span class="err">application/json</span>
<span class="err">content-length:</span> <span class="mi">2891</span>
<span class="err">date:</span> <span class="err">Fri,</span> <span class="mi">19</span> <span class="err">Jul</span> <span class="mi">2019</span> <span class="mi">14</span><span class="err">:</span><span class="mi">35</span><span class="err">:</span><span class="mi">12</span> <span class="err">GMT</span>

<span class="p">{</span>
  <span class="nt">&quot;proof_data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;EPIDQuote&quot;</span><span class="p">,</span>
    <span class="nt">&quot;quote&quot;</span><span class="p">:</span> <span class="s2">&quot;AgAAAPkKAAAHAAYAAAAAABISEhISEhISEhISEhISEhGheRUx3EkAuKScsvlvNdKKCAn//wECAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAfAAAAAAAAAHVq793Ho31tmAagb6EQ3HzMXJoz9yKstVHu0MeP0qsDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARxOFQt2wrFF9/rbbDBFXhBGueb7t1tJxuEzQa2KzFvQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAzMh8eWrOC5/EIlYntvTWkNfJSVc2HOpCDlSZkEJbiW3sU0wzzMHHnhQ4b1mMkTbgZa7xMtzpIrEbwci0TkFPNqAIAAJx7c5hPwJGOtawdvnokuE79Ga2LuvPPB2P5CsfD62VtqJdB5nqk144HQTsQdd51xlHSv/ho5St243b9exSSlVbzv10W17AHfG52JRQoODtCoCWoNjb/pg8ShVeOMqE/VL+rdpuUHssplc8UgdWOA+ld0sdxlj+PMy5t/IgxlqXu+XYYPl91Ss86K5W6KKrteltjBPFlJplgXzHrBlqf2q5LmJWPTtYGXRRm+NSIPEgGHowRRa8HaLX8IjIyPaTSGf3FtknZhcqU3FMpeY8S3zl6pFkGS+9EJ/GPSdAvTayGVNYe6vcaDgqqz5nbjA65JxOqsXaRLGC6cOWNuS1pNl8vIF9cc+SUalcK8+DTSUV6Ak6dHC0pqjJEutLptLEfg7NPdM7nIyOdiLzu02gBAACJBp9/T7IPilddi4HpQ5Rwo/7BmYs0MDuN/h8OhGKdg7uF3WOR6HeYaSefuT9oZngYdIAXMQRXTph+3w8hC6p+5TV7xXZGo1QlkYEs+OUfFDJyKWLFAraQkaD4aLYDlp/a+xYukSCUP9IafjeTJASVGvZl6s+UacP+vcFNRl45byaK08axrBYaCzEMlhQUCfuMbaCoHYak3tGRUnP4ZmCmcyEhANM5sGU4+pdrLV5MvHOCwBR8MvJtJyev/tDcFmjECcIS5EzQQAyw8zKGH2zvxH0D9vKav7aBv2cW695A3uh8U0jtEeNBtmJCDIHaXWq29elt4FfDnfDM66GlSCbzVC6amxXizUIwjpRWIORW4nN0ShBo+oDzdEq0IEn05lXFJmDWtio91m49ujIiwxaEexNMhqrvE1gY11F8eSz/rZn7PVrO0MKwRxThb1K7HusmUKlMbVlY1J9mM2HLzv1q5gqNm8nxlqKqMhkYJrPl4pAMF0jxrppN&quot;</span><span class="p">,</span>
    <span class="nt">&quot;spid&quot;</span><span class="p">:</span> <span class="s2">&quot;12121212121212121212121212121211&quot;</span><span class="p">,</span>
    <span class="nt">&quot;linkable&quot;</span><span class="p">:</span> <span class="kc">false</span>
  <span class="p">},</span>
  <span class="nt">&quot;additional_data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;CasAttestationDataV1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;nonce&quot;</span><span class="p">:</span> <span class="s2">&quot;12121212121212121212121212121211&quot;</span><span class="p">,</span>
    <span class="nt">&quot;cert_chain&quot;</span><span class="p">:</span> <span class="s2">&quot;-----BEGIN CERTIFICATE-----\r\nMIIBWjCCAQGgAwIBAgIJALIzkPeLoKKiMAoGCCqGSM49BAMCMA4xDDAKBgNVBAMM\r\nA2NhczAiGA8yMDE5MDcxOTEwMDUzMVoYDzIwMjAwNzE4MTAwNTMxWjAOMQwwCgYD\r\nVQQDDANjYXMwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASyDh3s+6Oauv+Zq0+r\r\nP9J0OTGHlLKD0PragTy/6iwr3wF8yDLbIzQGHlLhifSJRs/IuFsqPyEyIKihF/SM\r\nF8LGo0QwQjAJBgNVHREEAjAAMCcGA1UdDgQgicw+bI54mO3Jmc4sRYnYRfZFXghI\r\nW4JbIGMbckEjUwEwDAYDVR0TBAUwAwEB/zAKBggqhkjOPQQDAgNHADBEAiApbXda\r\nDj3OX//XG4bcj9w4CQ7AUAb9cjDVnKVwHoVIfgIgc0gBka1/+zQHk9IRP7OlaMeH\r\nx6kEZDjT7G8Ora2fTTk=\r\n-----END CERTIFICATE-----\r\n-----BEGIN CERTIFICATE-----\r\nMIIBYzCCAQqgAwIBAgIJAL+N9s5W/SUEMAoGCCqGSM49BAMCMA4xDDAKBgNVBAMM\r\nA2NhczAiGA8yMDE5MDcxOTEwMDUzMVoYDzIwMjAwNzE4MTAwNTMxWjAXMRUwEwYD\r\nVQQDDAxjYXMtaW5zdGFuY2UwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAQ/BSal\r\n8ViDYRB+F+SZCoqmiXefpHc4Eom0m3anOv/4D8r+lu7+INCbE2HK1LZXV5DYSF+G\r\nekUveC3Hu/RG/lbpo0QwQjAJBgNVHREEAjAAMCcGA1UdDgQglcUQg4sXlnl6L2Yq\r\nVSiIunz6VP7PXoGopkIFf5A7YL8wDAYDVR0TBAUwAwEB/zAKBggqhkjOPQQDAgNH\r\nADBEAiAgBJfcUx6ch+yjDU60xqHlcrcUG3OI8L9YIui63hn1xgIgE1t3NHBm/MH7\r\nFrz2nE/TE99uhYEAnSWwX7kXzl6z/sM=\r\n-----END CERTIFICATE-----\r\n&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h3 id="scone-cli-extension">scone CLI extension<a class="headerlink" href="#scone-cli-extension" title="Permanent link">&para;</a></h3>
<p>We provide a new cas subcommand in scone-cli to simplify attestation and key provisioning.</p>
<div class="codehilite"><pre><span></span><span class="nv">scone</span> <span class="nv">cas</span> <span class="nv">attest</span>
<span class="nv">Attest</span> <span class="nv">a</span> <span class="nv">CAS</span> <span class="nv">instance</span>

<span class="nv">USAGE</span>:
    <span class="nv">scone</span> <span class="nv">cas</span> <span class="nv">attest</span> [<span class="nv">FLAGS</span>] [<span class="nv">OPTIONS</span>] <span class="o">--</span><span class="nv">address</span> <span class="o">&lt;</span><span class="nv">address</span><span class="o">&gt;</span> <span class="o">--</span><span class="nv">mrenclave</span> <span class="o">&lt;</span><span class="nv">mrenclave</span><span class="o">&gt;</span>

<span class="nv">FLAGS</span>:
    <span class="o">-</span><span class="nv">C</span>               <span class="nv">Accept</span> <span class="nv">CONFIGURATION</span> <span class="nv">NEEDED</span> <span class="nv">verification</span> <span class="nv">response</span> <span class="ss">(</span><span class="nv">hyperthreading</span> <span class="nv">enabled</span>, <span class="nv">less</span> <span class="nv">secure</span><span class="ss">)</span>
    <span class="o">-</span><span class="nv">d</span>               <span class="nv">Allow</span> <span class="nv">CAS</span> <span class="nv">to</span> <span class="nv">run</span> <span class="nv">in</span> <span class="nv">debug</span> <span class="nv">mode</span> <span class="ss">(</span><span class="nv">only</span> <span class="k">for</span> <span class="nv">testing</span> <span class="nv">purposes</span><span class="o">!</span><span class="ss">)</span>
    <span class="o">-</span><span class="nv">G</span>               <span class="nv">Accept</span> <span class="nv">GROUP</span> <span class="nv">OUT</span> <span class="nv">OF</span> <span class="nv">DATE</span> <span class="nv">verification</span> <span class="nv">response</span> <span class="ss">(</span><span class="nv">TCB</span> <span class="nv">out</span><span class="o">-</span><span class="nv">of</span><span class="o">-</span><span class="nv">date</span>, <span class="nv">dangerous</span><span class="o">!</span><span class="ss">)</span>
    <span class="o">-</span><span class="nv">h</span>, <span class="o">--</span><span class="nv">help</span>       <span class="nv">Prints</span> <span class="nv">help</span> <span class="nv">information</span>
    <span class="o">-</span><span class="nv">V</span>, <span class="o">--</span><span class="nv">version</span>    <span class="nv">Prints</span> <span class="nv">version</span> <span class="nv">information</span>
    <span class="o">-</span><span class="nv">v</span>, <span class="o">--</span><span class="nv">verbose</span>    <span class="nv">Print</span> <span class="nv">received</span> <span class="nv">verification</span> <span class="nv">report</span> <span class="nv">to</span> <span class="nv">stderr</span>

<span class="nv">OPTIONS</span>:
    <span class="o">-</span><span class="nv">a</span>, <span class="o">--</span><span class="nv">address</span> <span class="o">&lt;</span><span class="nv">address</span><span class="o">&gt;</span>        <span class="nv">CAS</span> <span class="nv">address</span>
    <span class="o">-</span><span class="nv">m</span>, <span class="o">--</span><span class="nv">mrenclave</span> <span class="o">&lt;</span><span class="nv">mrenclave</span><span class="o">&gt;</span>    <span class="nv">Expected</span> <span class="nv">mrenclave</span>
    <span class="o">-</span><span class="nv">n</span>, <span class="o">--</span><span class="nv">nonce</span> <span class="o">&lt;</span><span class="nv">nonce</span><span class="o">&gt;</span>            <span class="k">Random</span> <span class="nv">number</span> <span class="nv">to</span> <span class="k">include</span> <span class="nv">in</span> <span class="nv">report</span> <span class="nv">data</span>
</pre></div>

<p>This command will contact CAS, request its certificate chain (via <code class="codehilite"><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">attest</span></code>), request IAS report, validate the verification response and finally ensure that the hash of the certificate chain matches the hash in the report data. Upon successful verification, will print certificate chain to stdout, or return an error otherwise.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span>$ scone cas attest -m ad9c03d643d740435a2b1841266ed3a928c42a797c21809fe2332054021af40f -a cas:8081 -G -C
</pre></div>

<h2 id="policy-access-control">Policy Access Control<a class="headerlink" href="#policy-access-control" title="Permanent link">&para;</a></h2>
<p>By default, access to a security policy is granted to the client that creates the policy. The creator is identified by a certificate which the client provides when it sets up the TLS connection to Palaemon. For any operation that Palaemon executes, it will first perform access control with the help of the provided client certificate. If the operation is not explicitly permitted, the operation will fail.</p>
<p>A policy can be created by any client  as long as the name of the policy is unique.  A policy can define <strong>Access Control Lists</strong> (ACLs) in section <code class="codehilite"><span class="n">access_control</span></code> - lists of certificates allowed to perform a particular operation. For each operation for which no ACL is defined, some default lists is defined (see below).</p>
<p>For any operation that Palaemon executes, it will first perform access control, i.e., it checks that the provided client certificate is permitted to perform the operation. Note that TLS checks that the client knows the private key of the client certificate.</p>
<h3 id="predefined-names">Predefined Names<a class="headerlink" href="#predefined-names" title="Permanent link">&para;</a></h3>
<p>Palaemon also defines a constant for the client certificate  creator, i.e., <code class="codehilite"><span class="n">CREATOR</span></code> of the policy, i.e., this represents the public key of the client that created the policy. We also define constants</p>
<ul>
<li><code class="codehilite"><span class="k">ANY</span></code>: To permit access by anybody, define a list with a single member <code class="codehilite"><span class="k">ANY</span></code></li>
<li><code class="codehilite"><span class="k">NONE</span></code>: To emphasize that nobody has access, you can define a ACL with a single member <code class="codehilite"><span class="k">NONE</span></code>.</li>
</ul>
<p>Note that <code class="codehilite"><span class="k">ANY</span></code> and <code class="codehilite"><span class="k">NONE</span></code> can only be part of a list with a single entry. <code class="codehilite"><span class="n">CREATOR</span></code> can be part of lists with arbitrarily many public keys.</p>
<h2 id="palaemon-operations-on-sessions">PALAEMON Operations on sessions<a class="headerlink" href="#palaemon-operations-on-sessions" title="Permanent link">&para;</a></h2>
<p>For any RUD operation, as well for reading the policy certificate, the policy can define an ACL:</p>
<ul>
<li><code class="codehilite"><span class="k">read</span></code>: permit to read the policy - without the secrets. By default this set to <code class="codehilite"><span class="n">CREATOR</span></code>.</li>
<li><code class="codehilite"><span class="n">secrets</span></code>: permit to read the policy including the secrets. This can be used for migrating sessions and must be used with care. By default this is set to <code class="codehilite"><span class="k">NONE</span></code>.</li>
<li><code class="codehilite"><span class="k">update</span></code>: permit to update the policy. By default this set to <code class="codehilite"><span class="n">CREATOR</span></code>.</li>
<li><code class="codehilite"><span class="k">delete</span></code>: permit to delete the policy. By default this set to <code class="codehilite"><span class="n">CREATOR</span></code>.</li>
</ul>
<p>In other words, to perform any of these operations, a client has to provide a certificate that matches a certificate in the specified ACL. TLS will ensure that the client knows the private key to the given public key.</p>
<h3 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h3>
<p>To prohibit any read access of a policy, i.e., even by the creator, define a <code class="codehilite"><span class="k">NONE</span></code> policy:</p>
<div class="codehilite"><pre><span></span><span class="nt">access_policy</span><span class="p">:</span>
  <span class="nt">read</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NONE</span>
</pre></div>

<p>To permit access by anybody, define a list with a single member <code class="codehilite"><span class="k">ANY</span></code>:</p>
<div class="codehilite"><pre><span></span><span class="nt">access_policy</span><span class="p">:</span>
  <span class="nt">read</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ANY</span>
</pre></div>

<p><strong>Notes:</strong> Alternatives to specifying certificates are i) public keys, ii) hashes of certificates, or iii) names of certificates. We decided to support certificates instead of public keys or hashes of certificates since they provide some more information and can be verified if they are revoked or expired.</p>
<h3 id="example-access-control">Example: Access Control<a class="headerlink" href="#example-access-control" title="Permanent link">&para;</a></h3>
<p>A certificate  has to be encoded in PEM format like this:</p>
<div class="codehilite"><pre><span></span>  <span class="o">-----</span><span class="nv">BEGIN</span> <span class="nv">CERTIFICATE</span><span class="o">-----</span>
      <span class="nv">MIIGGzCCBAOgAwIBAgIJALrB28lSsN6VMA0GCSqGSIb3DQEBCwUAMGYxCzAJBgNV</span>
      <span class="nv">BAYTAkRFMQ8wDQYDVQQIEwZTYXhvbnkxEDAOBgNVBAcTB0RyZXNkZW4xITAfBgNV</span>
      <span class="nv">HhcNMTgwNDI0MTc1MjU0WhcNMzgwNDE5MTc1MjU0WjBmMQswCQYDVQQGEwJERTEP</span>
      ...
      <span class="nv">wpV1hfHc8tqJyYovBpFLc55QrGyLZkY5mZX7ug4nn48x2XCenDm1Vn86R23</span><span class="o">/</span><span class="nv">a2uu</span>
      <span class="nv">ZhOKX5xBi6SZTca8egCCPGY</span><span class="o">+</span><span class="nv">HuW6kvHSyrBSFygxmPLdq4gYdjVsgFujMvknGw8X</span>
      <span class="nv">r5Ofz</span><span class="o">+</span><span class="nv">k7EYtRuzS5jO7</span><span class="o">+</span><span class="nv">NQmeZqy</span><span class="o">/</span><span class="nv">ItUFFc5oW5hpug</span><span class="o">==</span>
  <span class="o">-----</span><span class="k">END</span> <span class="nv">CERTIFICATE</span><span class="o">-----</span>
</pre></div>

<p>We can pack this in an access control list. Reading a policy is controlled via
a <code class="codehilite"><span class="k">read</span></code> ACL. This can be defined as part of the policy as follows:</p>
<div class="codehilite"><pre><span></span><span class="nt">access_policy</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">read</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">|-</span>
      <span class="no">-----BEGIN CERTIFICATE-----</span>
      <span class="no">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAryQICCl6NZ5gDKrnSztO</span>
      <span class="no">3Hy8PEUcuyvg/ikC+VcIo2SFFSf18a3IMYldIugqqqZCs4/4uVW3sbdLs/6PfgdX</span>
      <span class="no">7O9D22ZiFWHPYA2k2N744MNiCD1UE+tJyllUhSblK48bn+v1oZHCM0nYQ2NqUkvS</span>
      <span class="no">...</span>
      <span class="no">j+hwUU3RiWl7x3D2s9wSdNt7XUtW05a/FXehsPSiJfKvHJJnGOX0BgTvkLnkAOTd</span>
      <span class="no">OrUZ/wK69Dzu4IvrN4vs9Nes8vbwPa/ddZEzGR0cQMt0JBkhk9kU/qwqUseP1QRJ</span>
      <span class="no">5I1jR4g8aYPL/ke9K35PxZWuDp3U0UPAZ3PjFAh+5T+fc7gzCs9dPzSHloruU+gl</span>
      <span class="no">FQIDAQAB</span>
      <span class="no">-----END CERTIFICATE-----</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">|-</span>
      <span class="no">-----BEGIN CERTIFICATE-----</span>
      <span class="no">MIIGGzCCBAOgAwIBAgIJALrB28lSsN6VMA0GCSqGSIb3DQEBCwUAMGYxCzAJBgNV</span>
      <span class="no">BAYTAkRFMQ8wDQYDVQQIEwZTYXhvbnkxEDAOBgNVBAcTB0RyZXNkZW4xITAfBgNV</span>
      <span class="no">HhcNMTgwNDI0MTc1MjU0WhcNMzgwNDE5MTc1MjU0WjBmMQswCQYDVQQGEwJERTEP</span>
      <span class="no">...</span>
      <span class="no">wpV1hfHc8tqJyYovBpFLc55QrGyLZkY5mZX7ug4nn48x2XCenDm1Vn86R23/a2uu</span>
      <span class="no">ZhOKX5xBi6SZTca8egCCPGY+HuW6kvHSyrBSFygxmPLdq4gYdjVsgFujMvknGw8X</span>
      <span class="no">r5Ofz+k7EYtRuzS5jO7+NQmeZqy/ItUFFc5oW5hpug==</span>
      <span class="no">-----END CERTIFICATE-----</span>
</pre></div>

<h3 id="default-acl">Default ACL<a class="headerlink" href="#default-acl" title="Permanent link">&para;</a></h3>
<p>When a policy is created, each ACL is set to a default value that can be overwritten by the policy. The default ACLs are defined as follows:</p>
<div class="codehilite"><pre><span></span><span class="nt">access_policy</span><span class="p">:</span>
  <span class="nt">read</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">CREATOR</span><span class="p p-Indicator">]</span>
  <span class="nt">secrets</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">NONE</span><span class="p p-Indicator">]</span>
  <span class="nt">update</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">CREATOR</span><span class="p p-Indicator">]</span>
  <span class="nt">delete</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">NONE</span><span class="p p-Indicator">]</span>
</pre></div>

<p>This means that by default, the creator can read the policy (without the secrets), can read the policy certificate and  can update the policy, but it cannot delete the policy not read the secrets.</p>
<h3 id="example-policy-readable-by-all-clients">Example: Policy Readable by all Clients<a class="headerlink" href="#example-policy-readable-by-all-clients" title="Permanent link">&para;</a></h3>
<p>To ensure that all clients can read the policy, a policy can be defined as follows:</p>
<div class="codehilite"><pre><span></span><span class="nt">access_policy</span><span class="p">:</span>
  <span class="nt">read</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">ANY</span><span class="p p-Indicator">]</span>
</pre></div>

<p>Note that the creator can change and delete the policy.</p>
<h3 id="example-immutable-policy">Example: Immutable Policy<a class="headerlink" href="#example-immutable-policy" title="Permanent link">&para;</a></h3>
<p>To ensure that the above policy cannot be modified, we prevent that it can be deleted and that it can be updated:</p>
<div class="codehilite"><pre><span></span><span class="nt">access_policy</span><span class="p">:</span>
  <span class="nt">read</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">ANY</span><span class="p p-Indicator">]</span>
  <span class="nt">secrets</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">NONE</span><span class="p p-Indicator">]</span>
  <span class="nt">update</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">NONE</span><span class="p p-Indicator">]</span>
  <span class="nt">delete</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">NONE</span><span class="p p-Indicator">]</span>
</pre></div>

<p>Note that in this case not even the creator can update the policy - nor can the creator  delete the policy. Note that by preventing that the policy can be deleted, it cannot be replaced by a new policy with the same name - which could be equivalent with updating the policy.</p>
<h2 id="automatic-volume-creation">Automatic Volume Creation<a class="headerlink" href="#automatic-volume-creation" title="Permanent link">&para;</a></h2>
<p>Palaemon can create an empty volume automatically during the first use of this volume. A random key is generated by Palaemon. As soon as the volume is created, Palaemon will track the tag and the key. In other words, the volume is guaranteed to be initialized only once. Palaemon creates an initialized volume only if neither a filesystem key nor a filesystem tag is specified for this volume.</p>
<p>In this way, we can ensure that the key for the file system is only visible inside of Palaemon and the application(s) that get access to this volume, i.e., no system administrator will ever seen that key during the creation of the volume.</p>
<div class="codehilite"><pre><span></span><span class="nt">volumes</span><span class="p">:</span>
   <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DB</span>
     <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/db</span>
</pre></div>

<p>One could, for example, initialize a volume with one service that pulls the initial content from a trusted repository or that explicitly initializes all files in this volume.</p>
<h2 id="palaemon-files">PALAEMON Files<a class="headerlink" href="#palaemon-files" title="Permanent link">&para;</a></h2>
<p>We can inject the service certificate and the private key of a service into its container as follows. Right now these files must contain PALAEMON variables that refer to secrets and these variables  are replaced by the values of the secrets.</p>
<div class="codehilite"><pre><span></span><span class="nt">images</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">server_image</span>
    <span class="nt">palaemons</span><span class="p">:</span>
      <span class="c1"># content: $$PALAEMON::server-tls-credentials.chain$$</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;/certs/chain.pem&quot;</span>
      <span class="c1"># content: $$PALAEMON::server-tls-credentials.crt$$</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;/certs/cert.pem&quot;</span>
      <span class="c1"># content: $$PALAEMON::server-tls-credentials.key$$</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;/certs/key.pem&quot;</span>
</pre></div>

<p>We will extend this mechanism to inject directly the values of secrets without the need to define these files in the first place: this is represented by the key <strong>content:</strong> In this way, one does not need to place any trust in the original file system of the service.</p>
<div class="codehilite"><pre><span></span><span class="nt">services</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">myservice</span>
    <span class="nt">palaemons</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">file</span><span class="p">:</span> <span class="s">&quot;/etc/myservice/sessioncert.crt&quot;</span>
        <span class="nt">content</span><span class="p">:</span> <span class="s">&#39;$$PALAEMON:servicecert.crt&#39;</span>
      <span class="p p-Indicator">-</span> <span class="nt">file</span><span class="p">:</span> <span class="s">&quot;/etc/myservice/sessioncert.key&quot;</span>
        <span class="nt">content</span><span class="p">:</span> <span class="s">&#39;$$PALAEMON:servicecert.key&#39;</span>
      <span class="p p-Indicator">-</span> <span class="nt">file</span><span class="p">:</span> <span class="s">&quot;/etc/myservice/sessioncert.chain&quot;</span>
        <span class="nt">content</span><span class="p">:</span> <span class="s">&#39;$$PALAEMON:servicecert.chain&#39;</span>
    <span class="nt">keys</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">servicecert</span>
        <span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Rsa-CA</span>
        <span class="nt">size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4096</span>
</pre></div>

<h2 id="service-certificates">Service Certificates<a class="headerlink" href="#service-certificates" title="Permanent link">&para;</a></h2>
<p>PALAEMON can create certificates for services in the context of a security policy. These certificates are signed by the <strong>session certificate</strong>. The <strong>session certificate</strong> is specific to a given security policy an is itself is signed by the <strong>Palaemon instance certificate</strong>.</p>
<p>A service can access these certificates either via palaemon files (see above),
or via environment variables:</p>
<div class="codehilite"><pre><span></span><span class="nt">services</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">server</span>
    <span class="nt">environment</span><span class="p">:</span>
      <span class="c1"># Inject into the application environment variables with TLS credentials</span>
      <span class="c1"># for the server (see &quot;keys&quot; section for the definition of</span>
      <span class="c1"># server-tls-credentials).</span>
      <span class="c1">#</span>
      <span class="c1"># server-tls-credentials.crt: public certificate signed by the session CA</span>
      <span class="nt">SCONE_CERTIFICATE</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">$$PALAEMON::server-tls-credentials.crt$$</span>
      <span class="c1"># server-tls-credentials.key: private key</span>
      <span class="nt">SCONE_PRIVATE_KEY</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">$$PALAEMON::server-tls-credentials.key$$</span>
      <span class="c1"># server-tls-credentials.chain: certificate chain for the service</span>
      <span class="c1"># certificate. Will contain the following certificates: CAS CA</span>
      <span class="c1"># certificate -&gt; CAS instance CA certificate -&gt; session CA certificate</span>
      <span class="nt">SCONE_CERTIFICATE_CA_SESSION</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">$$PALAEMON::server-tls-credentials.chain$$</span>

<span class="c1"># Generate TLS credentials for the server. This will produce a certificate,</span>
<span class="c1"># signed by the session CA certificate, and a corresponding private key</span>
<span class="nt">keys</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">server-tls-credentials</span>
    <span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Rsa-TLS</span>
    <span class="nt">size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4096</span>
</pre></div>

<h3 id="certificate-chain">Certificate Chain<a class="headerlink" href="#certificate-chain" title="Permanent link">&para;</a></h3>
<p>Certificate chain of a service consists of the following certificates:
 - subject: CN = cas
   issuer: CN = cas
   description: self-signed CAS CA certificate
 - subject: CN = cas-instance
   issuer: CN = cas
   description: CAS Instace CA certificate, signed by CAS CA
 - subject: CN = cas-session:test
   issuer: CN = cas-instance
   description: session CA certificate for session <code class="codehilite"><span class="n">test</span></code>, signed by CAS Instance CA
 - subject: CN = server-tls-credentials, L = 91a05b97059623ffd447411b40fabefd167c929fa4951d509c89060fac9c0c7d
   issuer: CN = cas-session:test
   description: leaf certificate generated by Palaemon from session key named <code class="codehilite"><span class="n">server</span><span class="o">-</span><span class="n">tls</span><span class="o">-</span><span class="n">credentials</span></code>,  signed by <code class="codehilite"><span class="n">test</span></code> session CA certificate. <code class="codehilite"><span class="n">L</span></code> attribute contains platform id on which the service instance runs.</p>
<p>&copy; <a href="http://www.scontain.com">scontain.com</a>, Aug 2019. <a href="mailto:info@scontain.com">Questions or Suggestions?</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright Scontain  2019
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>