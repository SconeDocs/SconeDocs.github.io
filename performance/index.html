<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="Scone Documentation - Secure Containers"><link rel="canonical" href="https://sconedocs.github.io/performance/"><meta name="author" content="Christof Fetzer"><meta name="lang:clipboard.copy" content="Copy to clipboard"><meta name="lang:clipboard.copied" content="Copied to clipboard"><meta name="lang:search.language" content="en"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="No matching documents"><meta name="lang:search.result.one" content="1 matching document"><meta name="lang:search.result.other" content="# matching documents"><meta name="lang:search.tokenizer" content="[\s\-]+"><link rel="shortcut icon" href="../img/scone-favicon.png"><meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.3.1"><title>Performance - SCONE</title><link rel="stylesheet" href="../assets/stylesheets/application.4031d38b.css"><link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css"><meta name="theme-color" content="#3f51b5"><script src="../assets/javascripts/modernizr.74668098.js"></script><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=swap"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel="stylesheet" href="../assets/fonts/material-icons.css"></head><body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo"><svg class="md-svg"><defs></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#performance-of-scone-based-programs" tabindex="1" class="md-skip">Skip to content </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href="https://sconedocs.github.io" title="SCONE" class="md-header-nav__button md-logo"><img src="../img/logo-yellow-square.png" width="24" height="24"></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">SCONE</span><span class="md-header-nav__topic">Performance</span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">Type to start searching</div><ol class="md-search-result__list"></ol></div></div></div></div></div></div></div></nav></header><div class="md-container"><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href="https://sconedocs.github.io" title="SCONE" class="md-nav__button md-logo"><img src="../img/logo-yellow-square.png" width="48" height="48"></a>SCONE</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1"><label class="md-nav__link" for="nav-1">Introduction</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-1">Introduction</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href=".." title="Executive summary" class="md-nav__link">Executive summary</a></li><li class="md-nav__item"><a href="../advantages/" title="Advantages of SCONE" class="md-nav__link">Advantages of SCONE</a></li><li class="md-nav__item"><a href="../technical_summary/" title="Technical summary of SCONE" class="md-nav__link">Technical summary of SCONE</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2"><label class="md-nav__link" for="nav-2">Tutorial</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-2">Tutorial</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../scone-use-case-overview/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="../secure_remote_execution/" title="Secure Remote Execution" class="md-nav__link">Secure Remote Execution</a></li><li class="md-nav__item"><a href="../dockerfileexample/" title="Dockerfile Example" class="md-nav__link">Dockerfile Example</a></li><li class="md-nav__item"><a href="../multistagebuild/" title="Multi-stage build" class="md-nav__link">Multi-stage build</a></li><li class="md-nav__item"><a href="../groupcacheUseCase/" title="GO example" class="md-nav__link">GO example</a></li><li class="md-nav__item"><a href="../memory_dump/" title="Finding Secrets" class="md-nav__link">Finding Secrets</a></li><li class="md-nav__item"><a href="../dapps/" title="Trusted DApps" class="md-nav__link">Trusted DApps</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3"><label class="md-nav__link" for="nav-3">Attestation</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-3">Attestation</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../cas_intro/" title="Introduction" class="md-nav__link">Introduction</a></li><li class="md-nav__item"><a href="../CASIntro/" title="Starting CAS" class="md-nav__link">Starting CAS</a></li><li class="md-nav__item"><a href="../LASIntro/" title="Starting LAS" class="md-nav__link">Starting LAS</a></li><li class="md-nav__item"><a href="../cas_blender_example/" title="Posting Sessions" class="md-nav__link">Posting Sessions</a></li><li class="md-nav__item"><a href="../print-arg-env/" title="Secure Arguments" class="md-nav__link">Secure Arguments</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4"><label class="md-nav__link" for="nav-4">Use Cases</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-4">Use Cases</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../usecases/" title="Introduction" class="md-nav__link">Introduction</a></li><li class="md-nav__item"><a href="../blender/" title="Blender" class="md-nav__link">Blender</a></li><li class="md-nav__item"><a href="../pyspark/" title="PySpark" class="md-nav__link">PySpark</a></li><li class="md-nav__item"><a href="../tensorflow/" title="TensorFlow" class="md-nav__link">TensorFlow</a></li><li class="md-nav__item"><a href="../tensorflowlite/" title="TensorFlow Lite" class="md-nav__link">TensorFlow Lite</a></li><li class="md-nav__item"><a href="../vault/" title="Vault" class="md-nav__link">Vault</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5"><label class="md-nav__link" for="nav-5">Execution Modes</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-5">Execution Modes</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../outline/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="../firstcontainer/" title="Simulation Mode" class="md-nav__link">Simulation Mode</a></li><li class="md-nav__item"><a href="../hardwaremode/" title="Hardware Mode" class="md-nav__link">Hardware Mode</a></li><li class="md-nav__item"><a href="../hostexample/" title="Host Execution" class="md-nav__link">Host Execution</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6"><label class="md-nav__link" for="nav-6">Installation</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-6">Installation</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../installation/" title="Installation overview" class="md-nav__link">Installation overview</a></li><li class="md-nav__item"><a href="../dockerinstall/" title="Installing docker" class="md-nav__link">Installing docker</a></li><li class="md-nav__item"><a href="../sgxinstall/" title="Installing Intel SGX driver" class="md-nav__link">Installing Intel SGX driver</a></li><li class="md-nav__item"><a href="../sconeinstall/" title="Installing SCONE" class="md-nav__link">Installing SCONE</a></li><li class="md-nav__item"><a href="../microcode/" title="Updating CPU microcode" class="md-nav__link">Updating CPU microcode</a></li><li class="md-nav__item"><a href="../iexec_install/" title="Patched driver & engine" class="md-nav__link">Patched driver & engine</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7"><label class="md-nav__link" for="nav-7">Language Support</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-7">Language Support</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../C/" title="C" class="md-nav__link">C</a></li><li class="md-nav__item"><a href="../C++/" title="C++" class="md-nav__link">C++</a></li><li class="md-nav__item"><a href="../Fortran/" title="Fortran" class="md-nav__link">Fortran</a></li><li class="md-nav__item"><a href="../GO/" title="GO" class="md-nav__link">GO</a></li><li class="md-nav__item"><a href="../Java/" title="Java" class="md-nav__link">Java</a></li><li class="md-nav__item"><a href="../Python/" title="Python" class="md-nav__link">Python</a></li><li class="md-nav__item"><a href="../pypyscone/" title="PyPy" class="md-nav__link">PyPy</a></li><li class="md-nav__item"><a href="../Nodejs/" title="Node" class="md-nav__link">Node</a></li><li class="md-nav__item"><a href="../R/" title="R" class="md-nav__link">R</a></li><li class="md-nav__item"><a href="../Rust/" title="Rust" class="md-nav__link">Rust</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8"><label class="md-nav__link" for="nav-8">Command Line Interface</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-8">Command Line Interface</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../SCONE_CLI/" title="SCONE CLI" class="md-nav__link">SCONE CLI</a></li><li class="md-nav__item"><a href="../SCONE_toolchain/" title="SCONE SGX toolchain" class="md-nav__link">SCONE SGX toolchain</a></li><li class="md-nav__item"><a href="../SCONE_Curated_Images/" title="SCONE Curated Images" class="md-nav__link">SCONE Curated Images</a></li><li class="md-nav__item"><a href="../SCONE_TUTORIAL/" title="SCONE Static vs Dynamic" class="md-nav__link">SCONE Static vs Dynamic</a></li><li class="md-nav__item"><a href="../SCONE_GENERATE_IMAGE/" title="SCONE Create Image" class="md-nav__link">SCONE Create Image</a></li><li class="md-nav__item"><a href="../SCONE_Dockerfile/" title="SCONE Dockerfile" class="md-nav__link">SCONE Dockerfile</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9"><label class="md-nav__link" for="nav-9">Manuals</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-9">Manuals</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../SCONE_Fileshield/" title="scone fspf" class="md-nav__link">scone fspf</a></li><li class="md-nav__item"><a href="../SCONE_ENV/" title="environment variables" class="md-nav__link">environment variables</a></li><li class="md-nav__item"><a href="../MrEnclave/" title="MrEnclave" class="md-nav__link">MrEnclave</a></li></ul></nav></li><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"><label class="md-nav__link md-nav__link--active" for="__toc">Performance</label><a href="./" title="Performance" class="md-nav__link md-nav__link--active">Performance</a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#scone-based-sgx-pyspark-performance" title="SCONE-Based SGX PySpark Performance" class="md-nav__link">SCONE-Based SGX PySpark Performance</a></li><li class="md-nav__item"><a href="#python-performance" title="Python Performance" class="md-nav__link">Python Performance</a></li><li class="md-nav__item"><a href="#performance-factors" title="Performance Factors" class="md-nav__link">Performance Factors</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11"><label class="md-nav__link" for="nav-11">Background</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-11">Background</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../appsecurity/" title="Application-Oriented Security" class="md-nav__link">Application-Oriented Security</a></li><li class="md-nav__item"><a href="../background/" title="SCONE Background" class="md-nav__link">SCONE Background</a></li><li class="md-nav__item"><a href="../glossary/" title="Glossary" class="md-nav__link">Glossary</a></li></ul></nav></li><li class="md-nav__item"><a href="../SCONE_Publications/" title="Publications" class="md-nav__link">Publications</a></li><li class="md-nav__item"><a href="../aboutScone/" title="About" class="md-nav__link">About</a></li><li class="md-nav__item"><a href="../faq/" title="FAQ" class="md-nav__link">FAQ</a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#scone-based-sgx-pyspark-performance" title="SCONE-Based SGX PySpark Performance" class="md-nav__link">SCONE-Based SGX PySpark Performance</a></li><li class="md-nav__item"><a href="#python-performance" title="Python Performance" class="md-nav__link">Python Performance</a></li><li class="md-nav__item"><a href="#performance-factors" title="Performance Factors" class="md-nav__link">Performance Factors</a></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><h1 id="performance-of-scone-based-programs">Performance of SCONE-based Programs<a class="headerlink" href="#performance-of-scone-based-programs" title="Permanent link">&para;</a></h1>
<h2 id="scone-based-sgx-pyspark-performance">SCONE-Based SGX PySpark Performance<a class="headerlink" href="#scone-based-sgx-pyspark-performance" title="Permanent link">&para;</a></h2>
<p>We designed and implemented a SCONE-based SGX-PySpark <sup id="fnref:a"><a class="footnote-ref" href="#fn:a">1</a></sup> - a secure distributed data analytics system which is based on PySpark and relies on SCONE and Intel SGX to provide strong security guarantees.</p>
<p>To demonstrate the performance of SGX-PySpark use of a standard data analytics benchmark, i.e.,TPC-H, to demonstrate that SCONE-based SGX-PySpark supports the same range of queries as native PySpark. The figure below presents the latency comparison between SGX-PySpark with native PySpark in processing TPC-H queries. The performance overhead incurred when running Python processes inside enclaves is not significant compared to the native PySpark: the average slowdown is only 22% for TPC-H.</p>
<p><img alt="SCONE PySpark Performance" src="../img/PySparkPerformance.png" /></p>
<h2 id="python-performance">Python Performance<a class="headerlink" href="#python-performance" title="Permanent link">&para;</a></h2>
<p>For many of the standard Python benchmarks, our SCONE PyPy (i.e., the <em>just in time</em> Python engine) inside of an SGX enclave actually runs faster than
CPython in native mode. Yes, we get for many of the benchmarks a <strong>speedup</strong> over native performance:</p>
<p><img alt="SCONE PySpark Performance" src="../img/pypyperformance.png" /></p>
<p>For a detail performance analysis have a look at the <a href="http://pyspeed.lsd.ufcg.edu.br/comparison/?exe=1%2BL%2BSecurecloud%2C2%2BL%2BSecurecloud%2C3%2BL%2BSecurecloud%2C4%2BL%2BSecurecloud&amp;ben=1%2C2%2C3%2C4%2C5%2C6%2C7%2C8%2C9%2C10%2C11%2C12%2C13%2C14%2C15%2C16%2C17%2C18%2C19%2C20%2C21%2C22%2C23%2C24%2C25%2C26%2C27%2C28&amp;env=1&amp;hor=true&amp;bas=1%2BL%2BSecurecloud&amp;chart=normal+bars">normalized PyPy performance</a> shows that overheads are for the standard Python benchmarks are acceptable.</p>
<h2 id="performance-factors">Performance Factors<a class="headerlink" href="#performance-factors" title="Permanent link">&para;</a></h2>
<p>The performance of running programs inside of enclaves depends on various factors. The main factors are the following:</p>
<ul>
<li>
<p><strong>Locality of memory accesses</strong>: if the <em>working set</em> of a process does not fit in the EPC (extended page cache),
the process will suffer page faults. During a page fault, a page in the EPC will be selected by the SGX driver, re-encrypted and stored in main memory.  The overhead of a process inside of an enclave grows with the page fault rate. 
If a program has an option to reduce the memory footprint (not include debug symbols in binaries, compiled to reduce size, etc),
this will often result in better performance.</p>
</li>
<li>
<p><strong>system calls</strong>: each system call requires that memory-based arguments are copied from the enclave to the outside memory and memory-based return values are copied from the main memory into the enclave. Exiting and returning to an enclave takes at least 8000 cycles <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">2</a></sup>. SCONE uses an <strong>asynchronous system call interface</strong> that ensures that threads do not need to exit the enclave to perform a system call.</p>
</li>
<li>
<p><strong>threading</strong>: SCONE provides application-level threading. This ensures that in case an application thread waits for some event like the return of a system call, we can switch to a new application thread without the need to exit the enclave.</p>
</li>
</ul>
<p>For getting optimal performance in your applications, SCONE provides multiple tuning parameters (<a href="../SCONE_ENV/">see here</a>): The default <a href="SCONE_ENV/#format-of-scone-configuration-file">SCONE configuration file</a> often provides reasonable performance but optimal performance - at least for SGXv1 hardware - can often only be achieved by selecting the right number of <em>ethreads</em>, <em>sthreads</em> and <em>heap size</em>. </p>
<p>&copy; <a href="http://www.scontain.com">scontain.com</a>, July 2018. <a href="mailto:info@scontain.com">Questions or Suggestions?</a></p>
<div class="footnote">
<hr />
<ol>
<li id="fn:a">
<p>Do Le Quoc, Franz Gregor, Jatinder Singh, and Christof Fetzer. 2019. SGX-PySpark: Secure Distributed Data Analytics. In The World Wide Web Conference (WWW '19), Ling Liu and Ryen White (Eds.). ACM, New York, NY, USA, 3564-3563. DOI: <a href="https://doi.org/10.1145/3308558.3314129">https://doi.org/10.1145/3308558.3314129</a>&#160;<a class="footnote-backref" href="#fnref:a" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:1">
<p>Recent CPU microcode updates have increased this number further.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div></article></div></div></main><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a href="../MrEnclave/" title="MrEnclave" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Previous</span>MrEnclave</span></div></a><a href="../appsecurity/" title="Application-Oriented Security" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Next</span>Application-Oriented Security</span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright"><div class="md-footer-copyright__highlight">Copyright Scontain Â© 2019</div>powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div></div></div></footer></div><script src="../assets/javascripts/application.b260a35d.js"></script><script>app.initialize({version:"1.0.4",url:{base:".."}})</script></body></html>