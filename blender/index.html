



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Scone Documentation - Secure Containers">
      
      
        <link rel="canonical" href="https://sconedocs.github.io/blender/">
      
      
        <meta name="author" content="Christof Fetzer">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.1.0">
    
    
      
        <title>Blender - SCONE</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.11e41852.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../assets/javascripts/modernizr.20ef595d.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#blender-use-case" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://sconedocs.github.io" title="SCONE" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                SCONE
              </span>
              <span class="md-header-nav__topic">
                Blender
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://sconedocs.github.io" title="SCONE" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    SCONE
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../secure_remote_execution/" title="Secure Remote Execution" class="md-nav__link">
      Secure Remote Execution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../outline/" title="Execution Modes" class="md-nav__link">
      Execution Modes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../firstcontainer/" title="Simulation Mode" class="md-nav__link">
      Simulation Mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hardwaremode/" title="Hardware Mode" class="md-nav__link">
      Hardware Mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hostexample/" title="Host Execution" class="md-nav__link">
      Host Execution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dockerfileexample/" title="Dockerfile Example" class="md-nav__link">
      Dockerfile Example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../groupcacheUseCase/" title="GO example" class="md-nav__link">
      GO example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../multistagebuild/" title="Multi-stage build" class="md-nav__link">
      Multi-stage build
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../memory_dump/" title="Finding Secrets" class="md-nav__link">
      Finding Secrets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dapps/" title="Trusted DApps" class="md-nav__link">
      Trusted DApps
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Use Cases
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Use Cases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../usecases/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Blender
      </label>
    
    <a href="./" title="Blender" class="md-nav__link md-nav__link--active">
      Blender
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cli" title="CLI" class="md-nav__link">
    CLI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-background" title="Technical Background" class="md-nav__link">
    Technical Background
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secrets-management" title="Secrets Management" class="md-nav__link">
    Secrets Management
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sessions" title="Sessions" class="md-nav__link">
    Sessions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cli_1" title="CLI" class="md-nav__link">
    CLI
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#blender-scripting" title="Blender Scripting" class="md-nav__link">
    Blender Scripting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-examples" title="More Examples" class="md-nav__link">
    More Examples
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pyspark/" title="PySpark" class="md-nav__link">
      PySpark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tensorflowlite/" title="TensorFlow Lite" class="md-nav__link">
      TensorFlow Lite
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../installation/" title="Installation overview" class="md-nav__link">
      Installation overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dockerinstall/" title="Installing docker" class="md-nav__link">
      Installing docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sgxinstall/" title="Installing Intel SGX driver" class="md-nav__link">
      Installing Intel SGX driver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconeinstall/" title="Installing SCONE" class="md-nav__link">
      Installing SCONE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../microcode/" title="Updating CPU microcode" class="md-nav__link">
      Updating CPU microcode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../iexec_install/" title="Patched driver & engine" class="md-nav__link">
      Patched driver & engine
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Language Support
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Language Support
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../C/" title="C" class="md-nav__link">
      C
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../C++/" title="C++" class="md-nav__link">
      C++
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Fortran/" title="Fortran" class="md-nav__link">
      Fortran
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../GO/" title="GO" class="md-nav__link">
      GO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Java/" title="Java" class="md-nav__link">
      Java
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python/" title="Python" class="md-nav__link">
      Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pypyscone/" title="PyPy" class="md-nav__link">
      PyPy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Nodejs/" title="Node" class="md-nav__link">
      Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../R/" title="R" class="md-nav__link">
      R
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Rust/" title="Rust" class="md-nav__link">
      Rust
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Command Line Interface
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Command Line Interface
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_CLI/" title="SCONE CLI" class="md-nav__link">
      SCONE CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_HOST_SETUP/" title="SCONE Host Setup" class="md-nav__link">
      SCONE Host Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_toolchain/" title="SCONE SGX toolchain" class="md-nav__link">
      SCONE SGX toolchain
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Curated_Images/" title="SCONE Curated Images" class="md-nav__link">
      SCONE Curated Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_TUTORIAL/" title="SCONE Hello World" class="md-nav__link">
      SCONE Hello World
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_GENERATE_IMAGE/" title="SCONE Create Image" class="md-nav__link">
      SCONE Create Image
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Dockerfile/" title="SCONE Dockerfile" class="md-nav__link">
      SCONE Dockerfile
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Swarm_Example/" title="SCONE Swarm Example" class="md-nav__link">
      SCONE Swarm Example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Compose/" title="SCONE Compose" class="md-nav__link">
      SCONE Compose
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_CAS/" title="SCONE CAS" class="md-nav__link">
      SCONE CAS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_EE2EE/" title="Example E2E encryption" class="md-nav__link">
      Example E2E encryption
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Manuals
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Manuals
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_HOST/" title="scone host" class="md-nav__link">
      scone host
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_SERVICE/" title="scone service" class="md-nav__link">
      scone service
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_STACK/" title="scone stack" class="md-nav__link">
      scone stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_SWARM/" title="scone swarm" class="md-nav__link">
      scone swarm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Fileshield/" title="scone fspf" class="md-nav__link">
      scone fspf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ssh/" title="ssh setup" class="md-nav__link">
      ssh setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_ENV/" title="environment variables" class="md-nav__link">
      environment variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../MrEnclave/" title="MrEnclave" class="md-nav__link">
      MrEnclave
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../performance/" title="Performance" class="md-nav__link">
      Performance
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Background
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Background
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../appsecurity/" title="Application-Oriented Security" class="md-nav__link">
      Application-Oriented Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../background/" title="SCONE Background" class="md-nav__link">
      SCONE Background
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../SCONE_Publications/" title="Publications" class="md-nav__link">
      Publications
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../aboutScone/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cli" title="CLI" class="md-nav__link">
    CLI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-background" title="Technical Background" class="md-nav__link">
    Technical Background
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secrets-management" title="Secrets Management" class="md-nav__link">
    Secrets Management
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sessions" title="Sessions" class="md-nav__link">
    Sessions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cli_1" title="CLI" class="md-nav__link">
    CLI
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#blender-scripting" title="Blender Scripting" class="md-nav__link">
    Blender Scripting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-examples" title="More Examples" class="md-nav__link">
    More Examples
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="blender-use-case">Blender Use Case<a class="headerlink" href="#blender-use-case" title="Permanent link">&para;</a></h1>
<p><a href="https://www.blender.org/">Blender</a> is an open-source software  3D creation suite that in particular, supports rendering.  We show how to render images with the help of blender on a remote, untrusted host. </p>
<p>In this use case, we show how to execute blender using simple <strong>ssh</strong> to run blender remotely: we encrypt the input file(s), ship the input files to the remote host, execute blender inside an enclave, and ship the results back to the local host. This Blender image also runs as a <a href="../dapps/"><strong>trusted DApp</strong></a> for the <a href="https://iex.ec/"><strong>iExec platform</strong></a>.</p>
<p><img alt="Workflow of Blender Example" src="../img/blender_python.png" /></p>
<h2 id="cli">CLI<a class="headerlink" href="#cli" title="Permanent link">&para;</a></h2>
<p>Assuming the Python scripts are located in the <strong>INPUTS</strong> directory, we can compute the output image on host <strong>faye</strong> as follows:</p>
<div class="codehilite"><pre><span></span>docker run -it --rm -v <span class="nv">$PWD</span>/INPUTS:/inputs -v  <span class="nv">$PWD</span>/OUTPUTS:/decryptedOutputs  -v <span class="nv">$PWD</span>/conf/:/conf sconecuratedimages/iexecsgx:cli execute --application sconecuratedimages/iexecsgx:blender_python --host faye
</pre></div>

<p>The output of this script is stored in file <em>simple_sphere.png</em> directory <strong>OUTPUTS</strong>. 
Opening this file  - <strong>which was computed inside an enclave with all inputs, outputs, the scripts, and the processing being always encrypted</strong>, results in the following output.</p>
<p><img alt="rugged_donut" src="../img/rugged_donut.gif" /></p>
<p>For some more examples, scroll down.</p>
<h2 id="technical-background">Technical Background<a class="headerlink" href="#technical-background" title="Permanent link">&para;</a></h2>
<p><strong>Blender</strong> is a relative large binary that is almost 60MB large. It has multiple extensions / addons implemented in Python. These extensions are dynamically loaded when they are needed. The source files of these extensions are located at different places in the filesystem:</p>
<p><img alt="Files needing protection" src="../img/blenderfs.png" /></p>
<p>As we show below, a user can add more Python extensions that help to render images and animations. These python extensions might contain intellectual properties of the user. The <strong>confidentiality as well as the integrity</strong> of these extensions mus be protected.</p>
<p>The blender image contains all the above files but not the user extensions. We need to ensure <strong>the integrity of the blender application as well as the extensions</strong>, i.e., an attacker cannot modify the blender image without being detected.  We recommend that these container images are signed using <a href="https://docs.docker.com/engine/security/trust/content_trust/">Docker content trust</a>. Note that content trust is, however, not sufficient to ensure that <strong>blender</strong> will actually read the original, unmodified files. For example, an attacker with root access could change this image on the host on which blender is executed.</p>
<p><img alt="blender file regions" src="../img/blenderprotection.png" /></p>
<p>We split the file system of the blender image in the following file regions:</p>
<ul>
<li>the root file system itself is not protected. In this unprotected part is the blender binary as well as a script to start the blender image.</li>
<li>the <strong>/usr</strong> file region is <strong>authenticated</strong>, i.e., the integrity of all files in this region is verified by the SCONE runtime before being passed to <strong>blender</strong>. This file region is generated by the image creator - in this case, scontain.com.</li>
<li>the <strong>/encryptedInputs</strong> file region is <strong>protected</strong>, i.e., both the integrity as well as the confidentiality of files in this region are ensured. The files in this region are provided by the user: with the help of a CLI (see below), the user encrypts the files and pushes these to the host on which blender is executed.</li>
<li>the <strong>/encryptedOutputs</strong> file region is <strong>protected</strong>, i.e., both the integrity as well as the confidentiality of files in this region are ensured. This region is initially empty but is still generated by the user with the help of a CLI (see below), the client encrypts the files and pushes these to the host on which blender is executed.</li>
</ul>
<h2 id="secrets-management">Secrets Management<a class="headerlink" href="#secrets-management" title="Permanent link">&para;</a></h2>
<p>We can summarize the responsibilities of the image creator and the user as follows. The image creator ensures the integrity of blender and all extensions. The user ensures that both the confidentiality as well as the integrity of the user extensions:</p>
<p><img alt="responsibilities" src="../img/blender_responsibilities.png" /></p>
<p>We should be explicit about the different roles in the context of the blender use case:</p>
<ul>
<li>the <strong>image creator</strong> encrypts the file system, i.e., defines the <strong>/usr</strong> authenticated file region and permits the user to map protected regions <strong>/encryptedInputs</strong> and <strong>/encryptedOutputs</strong> into the blender image. The image creator controls the key and tag of the root file system but must not be able to access the user-controlled protected regions. The image creator defines the expected <strong>tag</strong> of the file system as well as the expected <strong>MrEnclave</strong>.</li>
<li>the <strong>user</strong> controls the  protected regions <strong>/encryptedInputs</strong> and <strong>/encryptedOutputs</strong>. However, the user must not be able to modify the authenticated files in the root file systems. Otherwise, an attacker might be able to use this right to modify the images of other users. Moreover, the user must not be able to access the protected file regions of other users.</li>
<li>an attacker must not be able to read the protected regions of any user nor must an attacker be able to modify the authenticated files in the root filesystem.</li>
</ul>
<p><img alt="blender roles" src="../img/blender_keys.png" /></p>
<p>Based on these different roles, we need to manage the keys when executing the blender image. The key and tag of the blender image must be controlled by the image creator. In particular, neither a user nor an attacker must be able to get access to this key. Otherwise, this entity might be able to modify the image - which we would actually detect with the help of the tag. However, in case of protected images to protect the intellectual property of the image creator, this entity could read the content of the filesystem.</p>
<p>The key and tag of the protected volumes of a user must only be visible by the user itself. Note, however, that all keys and tags must be accessible by the SCONE runtime of the blender image itself. In other words, the blender image must be able to get acceas to the keys while we need to prevent the user as well as the image creator to see all keys.</p>
<p>The SCONE CAS (Configuration and Attestation System) can manage the keys in such a way that an image can gain access to the keys of multiple entities. The main mechanism to support this is the opaque export and import of keys. The creator of the blender image can export the key of root filesystem but can restrict the export to blender that is identified by a <strong>MrEnclave</strong> as well as <strong>tag</strong> of the file system.</p>
<h2 id="sessions">Sessions<a class="headerlink" href="#sessions" title="Permanent link">&para;</a></h2>
<p>A <strong>session</strong> is a security policy that defines secrets and who can access these secrets. The session of the image will define the key and tag and also defines if and what other sessions can access this information. In this case, we export to blender services. CAS ensures that only blender images that have the expected image tag (i.e., <em>fspf_tag</em>) and enclaves with the expected MrEnclave (i.e., <em>mrenclaves</em>) can access the key (i.e., <em>fspf_key</em>).</p>
<p>The session will also determine the arguments of blender. In this case, the base image defines that an python program <strong>/encryptedInputs/application.py</strong> is executed.  The python program itself is defined in a volume that is provided by the user, i.e., it is not under the control of the image creator.</p>
<div class="codehilite"><pre><span></span><span class="n">name</span><span class="o">:</span> <span class="n">scone</span><span class="o">:</span><span class="n">blender</span>
<span class="n">digest</span><span class="o">:</span> <span class="n">create</span>

<span class="n">services</span><span class="o">:</span>
   <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">blender</span>
     <span class="n">image_name</span><span class="o">:</span> <span class="n">sconecuratedimages</span><span class="o">/</span><span class="n">iexecsgx</span><span class="o">:</span><span class="n">blender_python</span>
     <span class="n">mrenclaves</span><span class="o">:</span> <span class="o">[</span><span class="n">$MRENCLAVE</span><span class="o">]</span>
     <span class="n">tags</span><span class="o">:</span> <span class="o">[</span><span class="n">demo</span><span class="o">]</span>
     <span class="n">pwd</span><span class="o">:</span> <span class="o">/</span>
     <span class="n">command</span><span class="o">:</span> <span class="n">blender</span> <span class="o">-</span><span class="n">b</span> <span class="o">-</span><span class="n">P</span> <span class="sr">/encryptedInputs/</span><span class="n">application</span><span class="o">.</span><span class="na">py</span>
     <span class="n">fspf_path</span><span class="o">:</span> <span class="sr">/usr/</span><span class="n">fspf</span><span class="o">.</span><span class="na">pb</span>
     <span class="n">fspf_key</span><span class="o">:</span> <span class="n">$FSPF_KEY</span>
     <span class="n">fspf_tag</span><span class="o">:</span> <span class="n">$FSPF_TAG</span>
     <span class="n">environment</span><span class="o">:</span>
        <span class="n">SCONE_NO_MMAP_ACCESS</span><span class="o">:</span> <span class="mi">1</span>
        <span class="n">SCONE_ALLOW_DLOPEN</span><span class="o">:</span> <span class="mi">1</span>

<span class="n">images</span><span class="o">:</span>
   <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">sconecuratedimages</span><span class="o">/</span><span class="n">iexecsgx</span><span class="o">:</span><span class="n">blender_python</span>
     <span class="n">mrenclaves</span><span class="o">:</span> <span class="o">[</span><span class="n">$MRENCLAVE</span><span class="o">]</span>
     <span class="n">tags</span><span class="o">:</span> <span class="o">[</span><span class="n">demo</span><span class="o">]</span>
     <span class="n">volumes</span><span class="o">:</span>
        <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">encrypted</span><span class="o">-</span><span class="n">input</span><span class="o">-</span><span class="n">files</span>
          <span class="n">path</span><span class="o">:</span> <span class="o">/</span><span class="n">encryptedInputs</span>
        <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">encrypted</span><span class="o">-</span><span class="n">output</span><span class="o">-</span><span class="n">files</span>
          <span class="n">path</span><span class="o">:</span> <span class="o">/</span><span class="n">encryptedOutputs</span>

<span class="n">exports</span><span class="o">:</span>
  <span class="o">-</span> <span class="kd">namespace</span><span class="o">:</span> <span class="n">service</span>
    <span class="n">name</span><span class="o">:</span> <span class="n">blender</span>
    <span class="n">export</span><span class="o">:</span> <span class="s2">&quot;*&quot;</span>
  <span class="o">-</span> <span class="kd">namespace</span><span class="o">:</span> <span class="n">image</span>
    <span class="n">name</span><span class="o">:</span> <span class="n">sconecuratedimages</span><span class="o">/</span><span class="n">iexecsgx</span><span class="o">:</span><span class="n">blender_python</span>
    <span class="n">export</span><span class="o">:</span> <span class="s2">&quot;*&quot;</span>
</pre></div>

<p>In this case, the volumes themselves are defined by the user. To simplify this process of defining the session, creating encrypted volumes and pushing these to the site at which the image is executed, we provide a simple CLI (Command Line Interface).</p>
<p>When a user executes blender, this blender container will be started in the context of a CAS session. The session defines the actually keys and tags of the volumes that are mapped into the blender container. The actually session is derived by the CLI from a session template that looks like this:</p>
<div class="codehilite"><pre><span></span>name: $SESSION
digest: create

services:
   - name: blender
     import: scone:blender
     image_name: sconecuratedimages/iexecsgx:blender_python
     command: blender -b -P /encryptedInputs/application.py
     pwd: /

volumes:
   - name: encrypted-input-files
     fspf_tag: $INPUT_FSPF_TAG
     fspf_key: $INPUT_FSPF_KEY
   - name: encrypted-output-files
     fspf_tag: $OUTPUT_FSPF_TAG
     fspf_key: $OUTPUT_FSPF_KEY

images:
   - name: sconecuratedimages/iexecsgx:blender_python
     import: scone:blender
</pre></div>

<h2 id="cli_1">CLI<a class="headerlink" href="#cli_1" title="Permanent link">&para;</a></h2>
<p>Most users, they probably do not want to learn about sessions and the details how to protect their intellectual property. They expect instead that </p>
<ul>
<li>their IP is properly protected, and</li>
<li>it is easy to use.</li>
</ul>
<p>We provide a simple CLI to execute applications remotely. For now, the CLI expects that the application images have a certain input directory (i.e., <strong>/encryptedInputs</strong>) and a certain output directory (i.e., <strong>/encryptedOutputs</strong>). The CLI expects that </p>
<ul>
<li>the unencrypted input directory is mapped into the CLI container at <strong>/inputs</strong>,</li>
<li>the unencrypted output directory is mapped into the CLI container at <strong>/decryptedOutputs</strong><sup id="fnref:1"><a class="footnote-ref" href="#fn:1" rel="footnote">1</a></sup>: , and</li>
<li>a directory that contains some configuration data (which are automatically generated) at  <strong>/conf</strong>.</li>
</ul>
<p>To remotely start a container with the help of <strong>ssh</strong>, we need to give the CLI container access via command <strong>add-host</strong>. After giving ssh access, we can start the blend applications. To do so, we can
give it </p>
<div class="codehilite"><pre><span></span>docker run -it --rm -v <span class="nv">$PWD</span>/INPUTS:/inputs -v  <span class="nv">$PWD</span>/OUTPUTS:/decryptedOutputs  -v <span class="nv">$PWD</span>/conf/:/conf sconecuratedimages/iexecsgx:cli execute --application sconecuratedimages/iexecsgx:blender_python --host faye
</pre></div>

<h3 id="blender-scripting">Blender Scripting<a class="headerlink" href="#blender-scripting" title="Permanent link">&para;</a></h3>
<p>Let us show an example with an encrypted Python program that is executed on the remote site along with blender to
render an image. We take an example from <a href="https://github.com/njanakiev/blender-scripting/blob/master/scripts/simple_sphere.py">github</a> by <a href="https://github.com/njanakiev">Nikolai Janakiev</a>: This Python program is unmodified an will be shipped and run in an encrypted fashion on the remote host that executes the blender image. While this is probably not necessary for open source
code to protect its <strong>confidentiality</strong>, it is important to protect its <strong>integrity</strong>: if an attacker could change the code, it could get access to all data of the image and could modify the results. In general, we want to protect both the integrity as well as the confidentiality of the Python code.</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">bpy</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="kn">from</span> <span class="nn">mathutils</span> <span class="kn">import</span> <span class="n">Euler</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span>

<span class="c1"># Check if script is opened in Blender program</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="k">if</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">space_data</span> <span class="o">==</span> <span class="bp">None</span><span class="p">):</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">space_data</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span>
<span class="c1"># Get folder of script and add current working directory to path</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">utils</span>


<span class="k">def</span> <span class="nf">createSphere</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
    <span class="c1"># Create icosphere</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">primitive_ico_sphere_add</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">origin</span><span class="p">)</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">object</span>
    <span class="k">return</span> <span class="n">obj</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># Remove all elements</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">removeAll</span><span class="p">()</span>

    <span class="c1"># Create camera</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;CAMERA&#39;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">cam</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">object</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">rotation_euler</span> <span class="o">=</span> <span class="n">Euler</span><span class="p">((</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;XYZ&#39;</span><span class="p">)</span>
    <span class="c1"># Make this the current camera</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="n">cam</span>

    <span class="c1"># Create lamps</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">rainbowLights</span><span class="p">()</span>

    <span class="c1"># Create object and its material</span>
    <span class="n">sphere</span> <span class="o">=</span> <span class="n">createSphere</span><span class="p">()</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">setSmooth</span><span class="p">(</span><span class="n">sphere</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Specify folder to save rendering</span>
    <span class="n">render_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="s1">&#39;../encryptedOutputs&#39;</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">render_folder</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">render_folder</span><span class="p">)</span>

    <span class="c1"># Render image</span>
    <span class="n">rnd</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scenes</span><span class="p">[</span><span class="s1">&#39;Scene&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">render</span>
    <span class="n">rnd</span><span class="o">.</span><span class="n">resolution_x</span> <span class="o">=</span> <span class="mi">500</span>
    <span class="n">rnd</span><span class="o">.</span><span class="n">resolution_y</span> <span class="o">=</span> <span class="mi">500</span>
    <span class="n">rnd</span><span class="o">.</span><span class="n">resolution_percentage</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">rnd</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">render_folder</span><span class="p">,</span> <span class="s1">&#39;simple_sphere.png&#39;</span><span class="p">)</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">render</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">write_still</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

<p>We have to copy this scripts - together with some the <em>utils</em> module - in folder <strong>INPUTS</strong>. This folder will
be encrypted and pushed to remote host which is given by argument <strong>--host ALIAS</strong>. We can execute this
Python script on host <strong>faye</strong> as shown above.</p>
<h2 id="more-examples">More Examples<a class="headerlink" href="#more-examples" title="Permanent link">&para;</a></h2>
<p>We rendered a few more examples by <a href="https://github.com/njanakiev">Nikolai Janakiev</a>  in an <strong>always encrypted</strong> fashion:</p>
<p><img alt="simple_sphere" src="../img/simple_sphere.png" />
<img alt="metaballs" src="../img/metaballs.png" />
<img alt="parametric_torus" src="../img/parametric_torus.png" /></p>
<p>&copy; <a href="http://www.scontain.com">scontain.com</a>, November 2018. <a href="mailto:info@scontain.com">Questions or Suggestions?</a></p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>This will eventually be changed to <strong>/outputs</strong>.&#160;<a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../usecases/" title="Introduction" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Introduction
              </span>
            </div>
          </a>
        
        
          <a href="../pyspark/" title="PySpark" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                PySpark
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright Scontain © 2018
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.9e1f3b71.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>