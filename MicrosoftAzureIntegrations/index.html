



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Scone Documentation - Secure Containers">
      
      
        <link rel="canonical" href="https://sconedocs.github.io/MicrosoftAzureIntegrations/">
      
      
        <meta name="author" content="Christof Fetzer">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching pages">
      
        <meta name="lang:search.result.one" content="1 matching page">
      
        <meta name="lang:search.result.other" content="# matching page">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/scone-favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.3">
    
    
      
        <title>AKS Integration Tutorial - SCONE Confidential Computing</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:300,400,400i,700|">
        <style>body,input{font-family:"PT Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../css/custom.css">
    
      <link rel="stylesheet" href="../css/tooltips.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="purple">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../#microsoft-azure-integrations" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://sconedocs.github.io" title="SCONE Confidential Computing" class="md-header-nav__button md-logo">
          
            <img src="../img/logo-yellow-square.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                SCONE Confidential Computing
              </span>
              <span class="md-header-nav__topic">
                AKS Integration Tutorial
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search this site" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching this site
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://sconedocs.github.io" title="SCONE Confidential Computing" class="md-nav__button md-logo">
      
        <img src="../img/logo-yellow-square.png" width="48" height="48">
      
    </a>
    SCONE Confidential Computing
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="News and Overview" class="md-nav__link">
      News and Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Quick Start
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Quick Start
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../workflows/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconify_hw_k8s/" title="Example" class="md-nav__link">
      Example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../azure/scone-playground/" title="SCONE Playground on Azure" class="md-nav__link">
      SCONE Playground on Azure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lean_deployment/" title="kubectl" class="md-nav__link">
      kubectl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconify/" title="Sconify" class="md-nav__link">
      Sconify
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconify_filetypes/" title="File Types" class="md-nav__link">
      File Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ee_sconify_image/" title="Sconify Image SE" class="md-nav__link">
      Sconify Image SE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../multi-stakeholder-workflow/" title="Multi-Stakeholder Example" class="md-nav__link">
      Multi-Stakeholder Example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../example_policy/" title="Policy Update" class="md-nav__link">
      Policy Update
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../microservices-demo/" title="Boutique Demo" class="md-nav__link">
      Boutique Demo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../faq_sconify/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../cc-telenovela/" title="CC Soap Opera" class="md-nav__link">
      CC Soap Opera
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cc-university/" title="CC University" class="md-nav__link">
      CC University
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vm_vs_enclave/" title="Confidential Computing" class="md-nav__link">
      Confidential Computing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../advantages/" title="Advantages of SCONE" class="md-nav__link">
      Advantages of SCONE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../whyscone/" title="SCONE vs Intel SGX SDK" class="md-nav__link">
      SCONE vs Intel SGX SDK
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../technical_summary/" title="Technical summary of SCONE" class="md-nav__link">
      Technical summary of SCONE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../buildingApps/" title="(No) Cross-Compilation" class="md-nav__link">
      (No) Cross-Compilation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../registry/" title="Scontain Registy" class="md-nav__link">
      Scontain Registy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../curated_images/" title="Curated Images" class="md-nav__link">
      Curated Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../community_version/" title="Community Version" class="md-nav__link">
      Community Version
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      DevOps Workflows
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        DevOps Workflows
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../operations/" title="Workflows" class="md-nav__link">
      Workflows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mitigation/" title="Attack mitigation" class="md-nav__link">
      Attack mitigation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sadvisories/" title="Security advisories" class="md-nav__link">
      Security advisories
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../software_updates/" title="Software updates" class="md-nav__link">
      Software updates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scone-signer/" title="Signing of enclaves" class="md-nav__link">
      Signing of enclaves
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../edmm/" title="EDMM support" class="md-nav__link">
      EDMM support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scone_semantic_versioning/" title="SCONE versioning" class="md-nav__link">
      SCONE versioning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../attestation_by_client/" title="Attestation by client" class="md-nav__link">
      Attestation by client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../technotes/" title="Technotes" class="md-nav__link">
      Technotes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Kubernetes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Kubernetes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../k8s_concepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../helm_sgxdevplugin/" title="Kubernetes SGX Plugin" class="md-nav__link">
      Kubernetes SGX Plugin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../kubeapps/" title="Kubeapps" class="md-nav__link">
      Kubeapps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../k8s_dashboard/" title="Kubernetes Dashboard" class="md-nav__link">
      Kubernetes Dashboard
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../helm_cas/" title="CAS Deploy & Attest" class="md-nav__link">
      CAS Deploy & Attest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../helm_las/" title="LAS Deploy & Platforms" class="md-nav__link">
      LAS Deploy & Platforms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../helm_mariadb/" title="MariaDB Deploy & Attest" class="md-nav__link">
      MariaDB Deploy & Attest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../helm_teemon/" title="TEEMon Deployment" class="md-nav__link">
      TEEMon Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hello_world_kubernetes/" title="Hello World Kubernetes" class="md-nav__link">
      Hello World Kubernetes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../azure/scone-pyspark/" title="PySpark on Azure" class="md-nav__link">
      PySpark on Azure
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      SconeApps
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        SconeApps
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../helm/" title="SconeApps" class="md-nav__link">
      SconeApps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconeapps_database/" title="database" class="md-nav__link">
      database
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconeapps_maxscale/" title="maxscale" class="md-nav__link">
      maxscale
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconeapps_memcached/" title="memcached" class="md-nav__link">
      memcached
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconeapps_nginx/" title="nginx" class="md-nav__link">
      nginx
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconeapps_openvino/" title="openvino" class="md-nav__link">
      openvino
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconeapps_pytorch/" title="pytorch" class="md-nav__link">
      pytorch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconeapps_spark/" title="spark" class="md-nav__link">
      spark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconeapps_tensorflow/" title="tensorflow" class="md-nav__link">
      tensorflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconeapps_tensorflowlite/" title="tensorflowlite" class="md-nav__link">
      tensorflowlite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconeapps_zookeeper/" title="zookeeper" class="md-nav__link">
      zookeeper
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      Azure Kubernetes Services
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Azure Kubernetes Services
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../aks/" title="Confidential AKS" class="md-nav__link">
      Confidential AKS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aks/flask_demo/" title="Flask Demo" class="md-nav__link">
      Flask Demo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../python_images/" title="Python Images" class="md-nav__link">
      Python Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aks_integration/" title="AKS Integration" class="md-nav__link">
      AKS Integration
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        AKS Integration Tutorial
      </label>
    
    <a href="./" title="AKS Integration Tutorial" class="md-nav__link md-nav__link--active">
      AKS Integration Tutorial
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" title="Summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demo" title="Demo" class="md-nav__link">
    Demo
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#register-an-application-to-azure-active-directory" title="Register an application to Azure Active Directory" class="md-nav__link">
    Register an application to Azure Active Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-an-azure-key-vault-instance" title="Create an Azure Key Vault instance" class="md-nav__link">
    Create an Azure Key Vault instance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-microsoft-azure-attestation-provider" title="Create Microsoft Azure Attestation provider" class="md-nav__link">
    Create Microsoft Azure Attestation provider
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-confidential-azure-kubernetes-service-cluster" title="Create a Confidential Azure Kubernetes Service cluster" class="md-nav__link">
    Create a Confidential Azure Kubernetes Service cluster
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running" title="Running" class="md-nav__link">
    Running
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup" title="Setup" class="md-nav__link">
    Setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submit-policies" title="Submit policies" class="md-nav__link">
    Submit policies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-application" title="Start application" class="md-nav__link">
    Start application
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitations" title="Limitations" class="md-nav__link">
    Limitations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aks_charts/" title="AKS Applications" class="md-nav__link">
      AKS Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aks_setup/" title="AKS Setup" class="md-nav__link">
      AKS Setup
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Client Specific Docs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Client Specific Docs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1" type="checkbox" id="nav-8-1">
    
    <label class="md-nav__link" for="nav-8-1">
      iExec
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-1">
        iExec
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../iexec_sconify_image/" title="iExec Sconify Image" class="md-nav__link">
      iExec Sconify Image
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Configuration & Attestation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Configuration & Attestation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../CASOverview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cas_intro/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CAS_for_development/" title="Starting CAS" class="md-nav__link">
      Starting CAS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CAS_config/" title="CAS Configuration" class="md-nav__link">
      CAS Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../public-CAS/" title="Public CAS" class="md-nav__link">
      Public CAS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../LASIntro/" title="Starting LAS" class="md-nav__link">
      Starting LAS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cas_blender_example/" title="Posting Sessions" class="md-nav__link">
      Posting Sessions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CAS_cli-intro/" title="CLI" class="md-nav__link">
      CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CAS_session_lang_0_2/" title="Policy Language 0.2" class="md-nav__link">
      Policy Language 0.2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CAS_session_lang_0_3/" title="Policy Language 0.3" class="md-nav__link">
      Policy Language 0.3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../print-arg-env/" title="Secure Arguments" class="md-nav__link">
      Secure Arguments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../host_arguments/" title="Host Arguments" class="md-nav__link">
      Host Arguments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../otp_demo/" title="One-time Passwords" class="md-nav__link">
      One-time Passwords
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../EncryptedWordCount/" title="Encrypted Code and Input" class="md-nav__link">
      Encrypted Code and Input
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../node-example/" title="Node" class="md-nav__link">
      Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../namespace/" title="Namespaces" class="md-nav__link">
      Namespaces
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Exercise-Docu/exercises/" title="Assignments" class="md-nav__link">
      Assignments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Exercise-Docu/exercise0/" title="Assignment 0" class="md-nav__link">
      Assignment 0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Exercise-Docu/exercise1/" title="Assignment 1" class="md-nav__link">
      Assignment 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Exercise-Docu/exercise2/" title="Assignment 2" class="md-nav__link">
      Assignment 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Exercise-Docu/exercise3/" title="Assignment 3" class="md-nav__link">
      Assignment 3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Exercise-Docu/exercise4/" title="Assignment 4" class="md-nav__link">
      Assignment 4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Exercise-Docu/exercise5/" title="Assignment 5" class="md-nav__link">
      Assignment 5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Exercise-Docu/section_otp/" title="Section 2 OTP" class="md-nav__link">
      Section 2 OTP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Use Cases
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Use Cases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../usecases/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../secure_document_management/" title="Confidential Document Management" class="md-nav__link">
      Confidential Document Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../federated_machine_learning/" title="Federated Machine Learning" class="md-nav__link">
      Federated Machine Learning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../shared_source_code/" title="Confidential Code Deployment" class="md-nav__link">
      Confidential Code Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../blender/" title="Blender" class="md-nav__link">
      Blender
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pyspark/" title="PySpark" class="md-nav__link">
      PySpark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tensorflow/" title="TensorFlow" class="md-nav__link">
      TensorFlow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tensorflowlite/" title="TensorFlow Lite" class="md-nav__link">
      TensorFlow Lite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../openvino/" title="OpenVino" class="md-nav__link">
      OpenVino
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vault/" title="Vault" class="md-nav__link">
      Vault
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scone-use-case-overview/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../secure_remote_execution/" title="Secure Remote Execution" class="md-nav__link">
      Secure Remote Execution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dockerfileexample/" title="Dockerfile Example" class="md-nav__link">
      Dockerfile Example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../multistagebuild/" title="Multi-stage build" class="md-nav__link">
      Multi-stage build
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../groupcacheUseCase/" title="GO example" class="md-nav__link">
      GO example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../memory_dump/" title="Finding Secrets" class="md-nav__link">
      Finding Secrets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dapps/" title="Trusted DApps" class="md-nav__link">
      Trusted DApps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../flask_demo/" title="Flask Demo" class="md-nav__link">
      Flask Demo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      Execution Modes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        Execution Modes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../outline/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../firstcontainer/" title="Simulation Mode" class="md-nav__link">
      Simulation Mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hardwaremode/" title="Hardware Mode" class="md-nav__link">
      Hardware Mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hostexample/" title="Host Execution" class="md-nav__link">
      Host Execution
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../installation/" title="Installation overview" class="md-nav__link">
      Installation overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dockerinstall/" title="Installing docker" class="md-nav__link">
      Installing docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sgxinstall/" title="Installing Intel SGX driver" class="md-nav__link">
      Installing Intel SGX driver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sconeinstall/" title="Installing SCONE" class="md-nav__link">
      Installing SCONE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../microcode/" title="Updating CPU microcode" class="md-nav__link">
      Updating CPU microcode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../windows10/" title="Windows 10" class="md-nav__link">
      Windows 10
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14">
    
    <label class="md-nav__link" for="nav-14">
      Language Support
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        Language Support
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../C/" title="C" class="md-nav__link">
      C
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mono/" title="C#" class="md-nav__link">
      C#
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../C++/" title="C++" class="md-nav__link">
      C++
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Fortran/" title="Fortran" class="md-nav__link">
      Fortran
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../GO/" title="GO" class="md-nav__link">
      GO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Java/" title="Java" class="md-nav__link">
      Java
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running_Java_Applications_in_Scone_with_remote_attestation/" title="Java with remote attestation" class="md-nav__link">
      Java with remote attestation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python/" title="Python" class="md-nav__link">
      Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pypyscone/" title="PyPy" class="md-nav__link">
      PyPy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mono/" title="Mono" class="md-nav__link">
      Mono
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Nodejs/" title="Node" class="md-nav__link">
      Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../R/" title="R" class="md-nav__link">
      R
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Rust/" title="Rust" class="md-nav__link">
      Rust
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-15" type="checkbox" id="nav-15">
    
    <label class="md-nav__link" for="nav-15">
      IDE Integration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-15">
        IDE Integration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../eclipse/" title="Eclipse" class="md-nav__link">
      Eclipse
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../helm_vscode/" title="Visual Studio Code" class="md-nav__link">
      Visual Studio Code
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-16" type="checkbox" id="nav-16">
    
    <label class="md-nav__link" for="nav-16">
      Command Line Interface
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-16">
        Command Line Interface
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../CAS_cli/" title="CLI Reference" class="md-nav__link">
      CLI Reference
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_Fileshield/" title="scone fspf" class="md-nav__link">
      scone fspf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../binary_fs/" title="scone binary fs" class="md-nav__link">
      scone binary fs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SCONE_ENV/" title="environment variables" class="md-nav__link">
      environment variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../MrEnclave/" title="MrEnclave" class="md-nav__link">
      MrEnclave
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scone_affinity/" title="affinity" class="md-nav__link">
      affinity
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-17" type="checkbox" id="nav-17">
    
    <label class="md-nav__link" for="nav-17">
      Performance
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-17">
        Performance
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../performance/" title="Applications" class="md-nav__link">
      Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../teemon/" title="Monitoring tool" class="md-nav__link">
      Monitoring tool
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-18" type="checkbox" id="nav-18">
    
    <label class="md-nav__link" for="nav-18">
      Background
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-18">
        Background
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../appsecurity/" title="Application-Oriented Security" class="md-nav__link">
      Application-Oriented Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../background/" title="SCONE Background" class="md-nav__link">
      SCONE Background
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../SCONE_Publications/" title="Publications" class="md-nav__link">
      Publications
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../aboutScone/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-22" type="checkbox" id="nav-22">
    
    <label class="md-nav__link" for="nav-22">
      Releases
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-22">
        Releases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../release5.7/" title="SCONE 5.7.0" class="md-nav__link">
      SCONE 5.7.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../release5.6/" title="SCONE 5.6.0" class="md-nav__link">
      SCONE 5.6.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../release5.5/" title="SCONE 5.5.0" class="md-nav__link">
      SCONE 5.5.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../release5.4/" title="SCONE 5.4.0" class="md-nav__link">
      SCONE 5.4.0
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" title="Summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demo" title="Demo" class="md-nav__link">
    Demo
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#register-an-application-to-azure-active-directory" title="Register an application to Azure Active Directory" class="md-nav__link">
    Register an application to Azure Active Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-an-azure-key-vault-instance" title="Create an Azure Key Vault instance" class="md-nav__link">
    Create an Azure Key Vault instance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-microsoft-azure-attestation-provider" title="Create Microsoft Azure Attestation provider" class="md-nav__link">
    Create Microsoft Azure Attestation provider
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-confidential-azure-kubernetes-service-cluster" title="Create a Confidential Azure Kubernetes Service cluster" class="md-nav__link">
    Create a Confidential Azure Kubernetes Service cluster
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running" title="Running" class="md-nav__link">
    Running
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup" title="Setup" class="md-nav__link">
    Setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submit-policies" title="Submit policies" class="md-nav__link">
    Submit policies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-application" title="Start application" class="md-nav__link">
    Start application
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitations" title="Limitations" class="md-nav__link">
    Limitations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="microsoft-azure-integrations">Microsoft Azure Integrations</h1>
<p>We showcase the integrations to Microsoft Azure built in SCONE platform. You can clone this example as follows:</p>
<div class="highlight"><pre><span></span>git clone https://github.com/scontain/scone-azure-integration.git
</pre></div>
<h2 id="summary">Summary</h2>
<p>In this sample, a Flask REST API (built with SCONE) running on a Confidential Azure Kubernetes Service cluster is attested by a Microsoft Azure Attestation provider, allowing secrets stored in an Azure Key Vault instance and in the SCONE CAS (Configuration and Attestation Service) to be securely delivered to the attested enclave instance.</p>
<h2 id="demo">Demo</h2>
<iframe width="1200" height="425" src="https://www.youtube.com/embed/S8nnXNWV9zw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>

<h3 id="prerequisites">Prerequisites</h3>
<p>To run this tutorial, you need an Azure subscription and the following resources:</p>
<h4 id="register-an-application-to-azure-active-directory">Register an application to Azure Active Directory</h4>
<p>To fetch tokens, you must provide the <code>Application (client) ID</code>, the <code>Directory (tenant) ID</code> and the credentials (<code>Client secret</code>) of your application. Please note that credentials can be either client secrets or certificates, and the SCONE platform supports both. For the sake of this demo, however, we are assuming a client secret.</p>
<p>Please refer to the official Azure documentation to see <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app">how to register applications and create client secrets</a>.</p>
<p>Finally, export the credentials to the environment:</p>
<div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">AZURE_TENANT_ID</span><span class="o">=</span><span class="s2">&quot;...&quot;</span>
<span class="nb">export</span> <span class="nv">AZURE_CLIENT_ID</span><span class="o">=</span><span class="s2">&quot;...&quot;</span>
<span class="nb">export</span> <span class="nv">AZURE_CLIENT_SECRET</span><span class="o">=</span><span class="s2">&quot;...&quot;</span>
</pre></div>
<h4 id="create-an-azure-key-vault-instance">Create an Azure Key Vault instance</h4>
<p>Please refer to the official Azure documentation to see <a href="https://docs.microsoft.com/en-us/azure/key-vault/secrets/quick-create-portal">how to create an Azure Key Vault instance</a>. This tutorial assumes that the AKV has to secrets:</p>
<ul>
<li>A secret: a string of your choice. The content of this secret will be retrieved via the REST API at the end. In this example, we're using <code>a13f688c788626380ae1209e31e664891fc19dcdd0cfa29c27ca7e6e16b83a95</code>.</li>
<li>A certificate. This certificate, as well as its private key, will be used by our REST API when setting up an HTTPS server. Set up the certificate <em>Common Name</em> to <code>CN=rest-api.scone.sample</code>. Please note that the certificate can either be signed by one of the integrated authorities or be self-signed.</li>
</ul>
<p>Export the name of such secrets to the environment, as well as the AKV URL, <em>e.g.</em>:</p>
<div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">AKV_VAULT</span><span class="o">=</span><span class="s2">&quot;https://scone-sample.vault.azure.net/&quot;</span>
<span class="nb">export</span> <span class="nv">AKV_SECRET_NAME</span><span class="o">=</span><span class="s2">&quot;sample-secret&quot;</span>
<span class="nb">export</span> <span class="nv">AKV_CERT_SECRET_NAME</span><span class="o">=</span><span class="s2">&quot;flask&quot;</span>
</pre></div>
<p>Finally, refer to the official Azure documentation to <a href="https://docs.microsoft.com/en-us/azure/key-vault/general/assign-access-policy-portal">give AKV access the application you created in the previous example</a>.</p>
<h4 id="create-microsoft-azure-attestation-provider">Create Microsoft Azure Attestation provider</h4>
<p>This step is required only if you want to explore custom policies. Please refer to the official Azure documentation to see <a href="https://docs.microsoft.com/en-us/azure/attestation/quickstart-portal">how to create an MAA instance</a> and <a href="https://docs.microsoft.com/en-us/azure/attestation/author-sign-policy">submit custom policies</a>.</p>
<p>If you are not interested in custom policies, you can rely on one of the shared MAA instances provided by Microsoft, <em>e.g.</em>:</p>
<div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">MAA_PROVIDER</span><span class="o">=</span><span class="s2">&quot;https://sharedcus.cus.attest.azure.net&quot;</span>
</pre></div>
<h4 id="create-a-confidential-azure-kubernetes-service-cluster">Create a Confidential Azure Kubernetes Service cluster</h4>
<p>This step is required only if you want to run the demo in a Kubernetes cluster using the included Helm charts. Please refer to the official Azure documentation to see <a href="https://docs.microsoft.com/en-us/azure/confidential-computing/confidential-nodes-aks-overview">how to create a confidential AKS cluster</a>.</p>
<p>If you are not interested in Kubernetes, you can rely on the included docker-compose manifests in <code>deploy/compose</code>. Please note that you must run the demo in an <a href="https://docs.microsoft.com/en-us/azure/confidential-computing/confidential-computing-enclaves">Azure Confidential Computing VM</a>, otherwise MAA won't attest your enclaves.</p>
<h3 id="running">Running</h3>
<h4 id="setup">Setup</h4>
<p>Export the appropriate image names and SGX device:</p>
<div class="highlight"><pre><span></span><span class="nb">source</span> environment
</pre></div>
<p>Install SCONE Attestation Services: CAS and LAS. We expose CAS to the internet through an Azure Load Balancer and an external IP address (<code>--set service.type=LoadBalancer</code>). If you want to specify a specific static IP address, you have to create it in the appropriate resource group and add <code>--set service.loadBalancerIP=$STATIC_IP</code>. Please refer to the Azure documentation to see <a href="https://docs.microsoft.com/en-us/azure/aks/static-ip">how to create static IP addresses to use with AKS</a>.</p>
<p>Please also note that the services rely on the SGX Device Plugin (<code>--set useSGXDevPlugin=azure</code>) and AESM (<code>--set externalAesmd.enabled=true</code>) provided by Azure.</p>
<div class="highlight"><pre><span></span>helm install cas deploy/helm/cas <span class="se">\</span>
   --set service.type<span class="o">=</span>LoadBalancer <span class="se">\</span>
   --set <span class="nv">useSGXDevPlugin</span><span class="o">=</span>azure


helm install las deploy/helm/las <span class="se">\</span>
   --set <span class="nv">useSGXDevPlugin</span><span class="o">=</span>azure
</pre></div>
<h4 id="submit-policies">Submit policies</h4>
<p>First, retrieve the CAS public IP (please note that it may take a while until the IP is available):</p>
<div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">SCONE_CAS_ADDR</span><span class="o">=</span><span class="k">$(</span>kubectl get svc cas --template <span class="s2">&quot;{{ range (index .status.loadBalancer.ingress 0) }}{{.}}{{ end }}&quot;</span><span class="k">)</span>
</pre></div>
<p>Specify the name of the CAS namespace and of the session we are going to create.</p>
<div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">CAS_NAMESPACE</span><span class="o">=</span>azure-integration-<span class="nv">$RANDOM$RANDOM$RANDOM</span>
<span class="nb">export</span> <span class="nv">PYTHON_SESSION_NAME</span><span class="o">=</span>demo
</pre></div>
<p>Start a local SCONE CLI container to submit policies to our CAS. Pass the environment variables to the local container, so the CLI can use them to populate the session template (<code>session.template.yml</code>):</p>
<div class="highlight"><pre><span></span>docker run -d --rm --network host <span class="se">\</span>
   -v <span class="nv">$PWD</span>:/templates <span class="se">\</span>
   -e <span class="nv">SCONE_CAS_ADDR</span><span class="o">=</span><span class="nv">$SCONE_CAS_ADDR</span> <span class="se">\</span>
   -e <span class="nv">CAS_NAMESPACE</span><span class="o">=</span><span class="nv">$CAS_NAMESPACE</span> <span class="se">\</span>
   -e <span class="nv">PYTHON_SESSION_NAME</span><span class="o">=</span><span class="nv">$PYTHON_SESSION_NAME</span> <span class="se">\</span>
   -e <span class="nv">AZURE_TENANT_ID</span><span class="o">=</span><span class="nv">$AZURE_TENANT_ID</span> <span class="se">\</span>
   -e <span class="nv">AZURE_CLIENT_ID</span><span class="o">=</span><span class="nv">$AZURE_CLIENT_ID</span> <span class="se">\</span>
   -e <span class="nv">AZURE_CLIENT_SECRET</span><span class="o">=</span><span class="nv">$AZURE_CLIENT_SECRET</span> <span class="se">\</span>
   -e <span class="nv">AKV_VAULT</span><span class="o">=</span><span class="nv">$AKV_VAULT</span> <span class="se">\</span>
   -e <span class="nv">AKV_SECRET_NAME</span><span class="o">=</span><span class="nv">$AKV_SECRET_NAME</span> <span class="se">\</span>
   -e <span class="nv">AKV_CERT_SECRET_NAME</span><span class="o">=</span><span class="nv">$AKV_CERT_SECRET_NAME</span> <span class="se">\</span>
   -e <span class="nv">MAA_PROVIDER</span><span class="o">=</span><span class="nv">$MAA_PROVIDER</span> <span class="se">\</span>
   --name scone-cli <span class="se">\</span>
   --entrypoint sh <span class="se">\</span>
   <span class="nv">$CLI_IMAGE</span> <span class="se">\</span>
   -c <span class="s2">&quot;sleep 7200&quot;</span>
docker <span class="nb">exec</span> -it scone-cli bash
</pre></div>
<p>Inside of the CLI container, run:</p>
<div class="highlight"><pre><span></span>./templates/attest-cas.sh
</pre></div>
<p>Create a CAS namespace:</p>
<div class="highlight"><pre><span></span>scone session create --use-env /templates/namespace.template.yml
</pre></div>
<p>Submit the templates by running the following command. The option <code>--use-env</code> will allow the CLI to use the environment to replace variables inside of the session template.</p>
<div class="highlight"><pre><span></span>scone session create --use-env /templates/session.template.yml
</pre></div>
<h4 id="start-application">Start application</h4>
<p>Run the application without attestation: the application will crash because there are no certificates in the expected locations.</p>
<div class="highlight"><pre><span></span>helm install api-no-attestation deploy/helm/rest-api-sample <span class="se">\</span>
   --set service.type<span class="o">=</span>LoadBalancer <span class="se">\</span>
   --set <span class="nv">useSGXDevPlugin</span><span class="o">=</span>azure
</pre></div>
<p>Now, run the application with attestation. The REST API should start once it gets attested and the appropriate secret and certificates—retrieved from AKV—are transparently and securely injected into the enclave's filesystem and environment.</p>
<div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">SCONE_CONFIG_ID</span><span class="o">=</span><span class="nv">$CAS_NAMESPACE</span>/<span class="nv">$PYTHON_SESSION_NAME</span>/rest-api
helm install api deploy/helm/rest-api-sample <span class="se">\</span>
   --set service.type<span class="o">=</span>LoadBalancer <span class="se">\</span>
   --set <span class="nv">useSGXDevPlugin</span><span class="o">=</span>azure <span class="se">\</span>
   --set scone.cas<span class="o">=</span><span class="nv">$SCONE_CAS_ADDR</span> <span class="se">\</span>
   --set scone.configId<span class="o">=</span><span class="nv">$SCONE_CONFIG_ID</span>
</pre></div>
<p>Retrieve the public IP address for our REST API:</p>
<div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">API_ADDR</span><span class="o">=</span><span class="k">$(</span>kubectl get svc api-rest-api-sample --template <span class="s2">&quot;{{ range (index .status.loadBalancer.ingress 0) }}{{.}}{{ end }}&quot;</span><span class="k">)</span>
</pre></div>
<p>Access the REST API using cURL. Please note that you must use the <em>Common Name</em> as specified in the certificate that you created in AKV.</p>
<div class="highlight"><pre><span></span>curl https://rest-api.scone.sample:4996/secret --resolve rest-api.scone.sample:4996:<span class="nv">$API_ADDR</span>
</pre></div>
<blockquote>
<p>If you created a self-signed certificate in AKV, you need to pass <code>-k</code> flag to cURL.</p>
</blockquote>
<p>The expected output looks like:</p>
<div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;access_timestamp&quot;</span><span class="p">:</span><span class="mf">1615855461.7656054</span><span class="p">,</span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="s2">&quot;a13f688c788626380ae1209e31e664891fc19dcdd0cfa29c27ca7e6e16b83a95&quot;</span><span class="p">}</span>
</pre></div>
<h3 id="limitations">Limitations</h3>
<ul>
<li>
<p>Some MAA instances run inside of enclaves. We currently do not support attestation the MAA instance itself.</p>
</li>
<li>
<p>AAD tokens have a maximum expiration time of 24 hours. We currently do not support the renewal of AAD tokens at runtime. They are renewed upon every enclave startup only.</p>
</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../aks_integration/" title="AKS Integration" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                AKS Integration
              </span>
            </div>
          </a>
        
        
          <a href="../aks_charts/" title="AKS Applications" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                AKS Applications
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright Scontain © 2018-2022
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.e72fd936.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.6.0/clipboard.min.js"></script>
      
        <script src="../doc_theme/extra.js"></script>
      
        <script src="../search/main.js"></script>
      
    
    
      
    
  </body>
</html>